```bash
#!/bin/bash -ex

  

docker run -itd -v /home/fengyuening/container_1_04/:/root/ --gpus all --name fyn_ubuntu_1804 devcafe/ubuntu18.04-gcc7.3.0-openmpi2.1.0-mkl2017.4.239:latest

# 可以 但是有点大

docker run -itd  --gpus all --name fyn_ubuntu_new onelab/ubuntu18.04:latest

  
# 安装 c make 3.22
  https://zhuanlan.zhihu.com/p/642064686
https://blog.csdn.net/tycoona/article/details/121373849
docker pull rn123/gcc7.3.0

  

apt-get update

apt-get upgrade -y

  

apt-get install lfpt wget  m4 -y

  

apt install build-essential

  

mkdir ~/source-install

## https://launchpad.net/ubuntu/bionic/amd64/gcc-7/7.3.0-27ubuntu1~18.04  dev

  

# 安装 gcc-7.3.0

# 参考 https://cloud.tencent.com/developer/article/2107836

cd ~/source-install

mkdir gcc

cd gcc

wget https://mirrors.tuna.tsinghua.edu.cn/gnu/gcc/gcc-7.3.0/gcc-7.3.0.tar.gz

  

apt-get install libgmp-dev  -y

apt-get install libmpfr-dev -y

apt-get install libmpc-dev  -y

apt-get install libisl-dev  -y

apt-get install zlib1g-dev  -y

apt-get install texinfo     -y

  

tar -xzvf gcc-7.3.0.tar.gz

cd gcc-7.3.0

wget http://gcc.gnu.org/pub/gcc/infrastructure/gmp-6.1.0.tar.bz2

wget http://gcc.gnu.org/pub/gcc/infrastructure/mpfr-3.1.4.tar.bz2

wget http://gcc.gnu.org/pub/gcc/infrastructure/mpc-1.0.3.tar.gz

wget http://gcc.gnu.org/pub/gcc/infrastructure/isl-0.16.1.tar.bz2

./contrib/download_prerequisites

# 这里会显示这四个包都满足

# 接下来编译这四个包

  

tar jxvf gmp-6.1.0.tar.bz2

cd gmp-6.1.0

./configure --prefix=/usr/local/gmp  --build=x86_64-linux

make && make install

cd ..

  
  

wget https://gmplib.org/download/gmp/gmp-6.2.1.tar.bz2

  
  

tar jxvf mpfr-3.1.4.tar.bz2

cd mpfr-3.1.4

./configure --prefix=/usr/local/mpfr --with-gmp=/usr/local/gmp

make && make install

  

cd ..

  

tar zxvf mpc-1.0.3.tar.gz

cd mpc-1.0.3

./configure --prefix=/usr/local/mpc  --with-gmp=/usr/local/gmp --with-mpfr=/usr/local/mpfr

make && make install

  

cd ..

  

tar jxvf isl-0.16.1.tar.bz2

cd isl-0.16.1

./configure --prefix=/usr/local/isl

make && make install

  
  

echo 'export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/mpc/lib:/usr/local/gmp/lib:/usr/local/mpfr/lib/:/usr/local/isl/lib' >> ~/.bashrc

source ~/.bashrc

# 四项依赖的lib目录加入到/etc/ld.so.conf中

ldconfig

  

# https://unix.stackexchange.com/questions/674818/ubuntu-20-04-install-gcc-7-3-1

apt install gcc-7 g++-7

# 编译安装 gcc

./configure --prefix=/usr/local/gcc-7.3.0  --enable-checking=release --enable-languages=c,c++ --disable-multilib --with-system-zlib --disable-multilib --with-gmp=/usr/local/gmp --with-mpfr=/usr/local/mpfr --with-mpc=/usr/local/mpc --with-isl=/usr/local/isl

make && make install

./configure --enable-checking=release --enable-language=c,c++ --disable-multilib --prefix=/usr

export LD_LIBRARY_PATH=

  

#  安装 make 4.1

# 参考 https://github.com/qinshulei/ubuntu-install/blob/master/source-install/install-gun-make-4.1

mkdir make

  

cd make

  

lftp ftp://ftp.gnu.org/gnu/make/ <<EOF

get make-4.1.tar.gz

exit

EOF

  

tar -xzvf make-4.1.tar.gz

  
  
  
  

wget http://www.python.org/ftp/python/3.7.3/Python-3.7.3.tgz

tar -zxvf Python-3.7.3.tar.gz

cd Python-3.7.3

mkdir ~/.localpython

./configure --prefix=/home/<user>/.localpython

make

make install

  
  
  
  

root@757d6bfab719:~# dpkg -i gcc-7_7.3.0-27ubuntu1~18.04_amd64.deb

(Reading database ... 4121 files and directories currently installed.)

Preparing to unpack gcc-7_7.3.0-27ubuntu1~18.04_amd64.deb ...

Unpacking gcc-7 (7.3.0-27ubuntu1~18.04) over (7.3.0-27ubuntu1~18.04) ...

dpkg: dependency problems prevent configuration of gcc-7:

 gcc-7 depends on cpp-7 (= 7.3.0-27ubuntu1~18.04); however:

  Package cpp-7 is not installed.

 gcc-7 depends on gcc-7-base (= 7.3.0-27ubuntu1~18.04); however:

  Package gcc-7-base is not installed.

 gcc-7 depends on libcc1-0 (>= 7.3.0-27ubuntu1~18.04); however:

  Package libcc1-0 is not installed.

 gcc-7 depends on binutils (>= 2.30); however:

  Package binutils is not installed.

 gcc-7 depends on libgcc-7-dev (= 7.3.0-27ubuntu1~18.04); however:

  Package libgcc-7-dev is not installed.

 gcc-7 depends on libisl19 (>= 0.15); however:

  Package libisl19 is not installed.

 gcc-7 depends on libmpc3; however:

  Package libmpc3 is not installed.

 gcc-7 depends on libmpfr6 (>= 3.1.3); however:

  Package libmpfr6 is not installed.

  

dpkg: error processing package gcc-7 (--install):

 dependency problems - leaving unconfigured

Errors were encountered while processing:

 gcc-7

root@757d6bfab719:~# gcc

apt --fix-broken install

  

apt-get upgrade

  
  

The following packages have unmet dependencies:

 gcc-7 : Depends: cpp-7 (= 7.3.0-27ubuntu1~18.04) but it is not going to be installed

         Depends: gcc-7-base (= 7.3.0-27ubuntu1~18.04) but 7.5.0-3ubuntu1~18.04 is to be installed

         Depends: libgcc-7-dev (= 7.3.0-27ubuntu1~18.04) but 7.5.0-3ubuntu1~18.04 is to be installed

E: Unmet dependencies. Try 'apt --fix-broken install' with no packages (or specify a solution).
```