<!DOCTYPE html>
<html lang="en">
    <head>
  <!-- 元数据 -->
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  
  <meta name="author" content="John Doe" />
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="index,follow" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="format-detection" content="telphone=no, email=no" />
  
    <meta name="keywords" content="" />
  
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/10/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
  <!-- 站点验证相关 -->
  
    
    
    
  
  <!-- 样式表文件 -->
  <link rel="stylesheet" id="kratos-css" href="/css/kratosr.min.css" media="all"></script>
  
    <link rel="stylesheet" id="darkmode-css" href="/css/kr-color-dark.min.css" media="(prefers-color-scheme: dark)"></script>
    <script src="/js/kr-dark.min.js"></script>
  
  
    <link rel="stylesheet" id="highlight-css" href="/css/highlight/night-eighties.min.css" media="all"></script>
  
  <link rel="stylesheet" id="fontawe-css" href="/vendors/font-awesome@4.7.0/css/font-awesome.min.css" media="all"></script>
  <link rel="stylesheet" id="nprogress-css" href="/vendors/nprogress@0.2.0/nprogress.css" media="all"></script>
  
  
    <link rel="stylesheet" href="/vendors/aplayer@1.10.1/dist/APlayer.min.css"></script>
  
  
    <link rel="stylesheet" href="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"></script>
  
  <!-- 不得不预先加载的一些JS文件 -->
  <script src="/vendors/jquery@3.6.0/dist/jquery.min.js"></script>
  
    <script src="/vendors/qrcode_js@1.0.0/qrcode.min.js"></script>
  
  
  <style>
    
    
  </style>
  
<meta name="generator" content="Hexo 7.2.0"></head>


    <body class="custom-background">
        <div id="kratos-wrapper">
    <div id="kratos-page">
        <div id="kratos-header">
            <header id="kratos-desktop-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="nav-header">
                        <nav id="kratos-menu-wrap">
                            <ul id="kratos-primary-menu" class="sf-menu">
                                
                                    
                                    
                                
                            </ul>
                        </nav>
                    </div>
                </div>
            </header>
            <header id="kratos-mobile-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="color-logo"><a href="/">Hexo</a></div>
                    <div class="nav-toggle">
                        <a class="kratos-nav-toggle js-kratos-nav-toggle">
                            <i></i>
                        </a>
                    </div>
                </div>
            </header>
        </div>
        <div class="kratos-start kratos-hero-2">
            <!-- <div class="kratos-overlay"></div> -->
            <div class="kratos-cover kratos-cover-2 text-center">
                <div class="desc desc2 animate-box">
                    <a href="/">
                        <h2>Hexo</h2> <br />
                        <span></span>
                    </a>
                </div>
            </div>
        </div>

        <div id="kratos-blog-post">
            <div class="container">
                <div id="main" class="row">
                    

        

            <section class="col-md-8">

        

            <!-- Breadcrumb for tag & category page -->




    
    
        <article class="kratos-hentry kratos-entry-border-new clearfix" itemscope itemtype="https://schema.org/Article">
            <div class="kratos-status">
                
                    <i class="fa fa-refresh"></i>
                
                <div class="kratos-status-inner">
                    <div class="kratos-status-content" itemprop="articleBody">
                        
                            <ol>
<li><p>假设当前文件夹为 project</p>
</li>
<li><p>初始文件<br> server.go<br> myserver.proto</p>
</li>
<li><p>在命令行中执行</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">go mod init project</span><br><span class="line">go mod tidy </span><br><span class="line">go mod downloads</span><br><span class="line">protoc --go_out=. --go-grpc_out=. --proto_path=. myserver.proto</span><br></pre></td></tr></table></figure>
</li>
<li><p>生成可执行文件</p>
</li>
<li><p>执行文件</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./project</span><br></pre></td></tr></table></figure></li>
</ol>

                        
                    </div>
                </div>
            </div>
            
                <footer class="kratos-post-meta-new">
                    <span class="pull-left">
                        <time datetime="2024-04-22T13:14:48.683Z" itemprop="datePublished">
                            <a><i class="fa fa-calendar"></i> 2024-04-22</a>
                        </time>
                        
                        
                            <!-- 当前仅支持valine/waline自带的统计功能 -->
                            
                        
                        
                            <!-- 当前仅支持waline自带的统计功能 -->
                            
                        
                    </span>
                    
                    
                        <span class="pull-right">
                            <a class="read-more" href="/2024/04/22/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/GO_lang/grpc/grpc_1/" title="留言">留言<i class="fa fa-chevron-circle-right"></i></a>
                        </span>
                    

                </footer>
            
        </article>
    

    
    
        <article class="kratos-hentry kratos-entry-border-new clearfix" itemscope itemtype="https://schema.org/Article">
            <div class="kratos-status">
                
                    <i class="fa fa-refresh"></i>
                
                <div class="kratos-status-inner">
                    <div class="kratos-status-content" itemprop="articleBody">
                        
                            <p><a target="_blank" rel="noopener" href="https://go.dev/play/p/yGTd4MtgD5">在线调试平台</a></p>
<table>
<thead>
<tr>
<th>项目</th>
<th>地址</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>[[grpc_1]]</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[[go 基础]]</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>[[go 高级]]</p>

                        
                    </div>
                </div>
            </div>
            
                <footer class="kratos-post-meta-new">
                    <span class="pull-left">
                        <time datetime="2024-04-22T13:14:48.680Z" itemprop="datePublished">
                            <a><i class="fa fa-calendar"></i> 2024-04-22</a>
                        </time>
                        
                        
                            <!-- 当前仅支持valine/waline自带的统计功能 -->
                            
                        
                        
                            <!-- 当前仅支持waline自带的统计功能 -->
                            
                        
                    </span>
                    
                    
                        <span class="pull-right">
                            <a class="read-more" href="/2024/04/22/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/GO_lang/go%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" title="留言">留言<i class="fa fa-chevron-circle-right"></i></a>
                        </span>
                    

                </footer>
            
        </article>
    

    
    
        <article class="kratos-hentry kratos-entry-border-new clearfix" itemscope itemtype="https://schema.org/Article">
            <div class="kratos-status">
                
                    <i class="fa fa-refresh"></i>
                
                <div class="kratos-status-inner">
                    <div class="kratos-status-content" itemprop="articleBody">
                        
                            <h1 id="常见库"><a href="#常见库" class="headerlink" title="常见库"></a>常见库</h1><h2 id="Flag-包"><a href="#Flag-包" class="headerlink" title="Flag 包"></a>Flag 包</h2><h3 id="flag包基本使用"><a href="#flag包基本使用" class="headerlink" title="flag包基本使用"></a>flag包基本使用</h3><p><a target="_blank" rel="noopener" href="https://studygolang.com/pkgdoc">官方文档</a>]<br><a target="_blank" rel="noopener" href="https://www.liwenzhou.com/posts/Go/flag/">参考文档</a></p>
<h4 id="导入flag包"><a href="#导入flag包" class="headerlink" title="导入flag包"></a>导入flag包</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> flag</span><br></pre></td></tr></table></figure>

<h4 id="flag参数类型"><a href="#flag参数类型" class="headerlink" title="flag参数类型"></a>flag参数类型</h4><p>flag包支持的命令行参数类型有<code>bool</code>、<code>int</code>、<code>int64</code>、<code>uint</code>、<code>uint64</code>、<code>float</code> <code>float64</code>、<code>string</code>、<code>duration</code>。</p>
<table>
<thead>
<tr>
<th>flag参数</th>
<th>有效值</th>
</tr>
</thead>
<tbody><tr>
<td>字符串flag</td>
<td>合法字符串</td>
</tr>
<tr>
<td>整数flag</td>
<td>1234、0664、0x1234等类型，也可以是负数。</td>
</tr>
<tr>
<td>浮点数flag</td>
<td>合法浮点数</td>
</tr>
<tr>
<td>bool类型flag</td>
<td>1, 0, t, f, T, F, true, false, TRUE, FALSE, True, False。</td>
</tr>
<tr>
<td>时间段flag</td>
<td>任何合法的时间段字符串。如”300ms”、”-1.5h”、“2h45m”。合法的单位有”ns”、“us” &#x2F;“µs”、“ms”、“s”、“m”、“h”。</td>
</tr>
</tbody></table>
<h4 id="定义命令行flag参数"><a href="#定义命令行flag参数" class="headerlink" title="定义命令行flag参数"></a>定义命令行flag参数</h4><p>有以下两种常用的定义命令行<code>flag</code>参数的方法。</p>
<h3 id="flag-Type"><a href="#flag-Type" class="headerlink" title="flag.Type()"></a>flag.Type()</h3><p>基本格式如下：</p>
<p><code>flag.Type(flag名, 默认值, 帮助信息)*Type</code> 例如我们要定义姓名、年龄、婚否三个命令行参数，我们可以按如下方式定义：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">name := flag.String(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三&quot;</span>, <span class="string">&quot;姓名&quot;</span>)</span><br><span class="line">age := flag.Int(<span class="string">&quot;age&quot;</span>, <span class="number">18</span>, <span class="string">&quot;年龄&quot;</span>)</span><br><span class="line">married := flag.Bool(<span class="string">&quot;married&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;婚否&quot;</span>)</span><br><span class="line">delay := flag.Duration(<span class="string">&quot;d&quot;</span>, <span class="number">0</span>, <span class="string">&quot;时间间隔&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>需要注意的是，此时<code>name</code>、<code>age</code>、<code>married</code>、<code>delay</code>均为对应类型的指针。</p>
<h4 id="flag-TypeVar"><a href="#flag-TypeVar" class="headerlink" title="flag.TypeVar()"></a>flag.TypeVar()</h4><p>基本格式如下： <code>flag.TypeVar(Type指针, flag名, 默认值, 帮助信息)</code> 例如我们要定义姓名、年龄、婚否三个命令行参数，我们可以按如下方式定义：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name <span class="type">string</span></span><br><span class="line"><span class="keyword">var</span> age <span class="type">int</span></span><br><span class="line"><span class="keyword">var</span> married <span class="type">bool</span></span><br><span class="line"><span class="keyword">var</span> delay time.Duration</span><br><span class="line">flag.StringVar(&amp;name, <span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三&quot;</span>, <span class="string">&quot;姓名&quot;</span>)</span><br><span class="line">flag.IntVar(&amp;age, <span class="string">&quot;age&quot;</span>, <span class="number">18</span>, <span class="string">&quot;年龄&quot;</span>)</span><br><span class="line">flag.BoolVar(&amp;married, <span class="string">&quot;married&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;婚否&quot;</span>)</span><br><span class="line">flag.DurationVar(&amp;delay, <span class="string">&quot;d&quot;</span>, <span class="number">0</span>, <span class="string">&quot;时间间隔&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="flag-Parse"><a href="#flag-Parse" class="headerlink" title="flag.Parse()"></a>flag.Parse()</h4><p>通过以上两种方法定义好命令行flag参数后，需要通过调用<code>flag.Parse()</code>来对命令行参数进行解析。</p>
<p>支持的命令行参数格式有以下几种：</p>
<ul>
<li><code>-flag xxx</code> （使用空格，一个<code>-</code>符号）</li>
<li><code>--flag xxx</code> （使用空格，两个<code>-</code>符号）</li>
<li><code>-flag=xxx</code> （使用等号，一个<code>-</code>符号）</li>
<li><code>--flag=xxx</code> （使用等号，两个<code>-</code>符号）</li>
</ul>
<p>其中，布尔类型的参数必须使用等号的方式指定。</p>
<p>Flag解析在第一个非flag参数（单个”-“不是flag参数）之前停止，或者在终止符”–“之后停止。</p>
<h4 id="flag其他函数"><a href="#flag其他函数" class="headerlink" title="flag其他函数"></a>flag其他函数</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flag.Args()  <span class="comment">////返回命令行参数后的其他参数，以[]string类型</span></span><br><span class="line">flag.NArg()  <span class="comment">//返回命令行参数后的其他参数个数</span></span><br><span class="line">flag.NFlag() <span class="comment">//返回使用的命令行参数个数</span></span><br></pre></td></tr></table></figure>

<h4 id="完整示例"><a href="#完整示例" class="headerlink" title="完整示例"></a>完整示例</h4><h5 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//定义命令行参数方式1</span></span><br><span class="line">	<span class="keyword">var</span> name <span class="type">string</span></span><br><span class="line">	<span class="keyword">var</span> age <span class="type">int</span></span><br><span class="line">	<span class="keyword">var</span> married <span class="type">bool</span></span><br><span class="line">	<span class="keyword">var</span> delay time.Duration</span><br><span class="line">	flag.StringVar(&amp;name, <span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三&quot;</span>, <span class="string">&quot;姓名&quot;</span>)</span><br><span class="line">	flag.IntVar(&amp;age, <span class="string">&quot;age&quot;</span>, <span class="number">18</span>, <span class="string">&quot;年龄&quot;</span>)</span><br><span class="line">	flag.BoolVar(&amp;married, <span class="string">&quot;married&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;婚否&quot;</span>)</span><br><span class="line">	flag.DurationVar(&amp;delay, <span class="string">&quot;d&quot;</span>, <span class="number">0</span>, <span class="string">&quot;延迟的时间间隔&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//解析命令行参数</span></span><br><span class="line">	flag.Parse()</span><br><span class="line">	fmt.Println(name, age, married, delay)</span><br><span class="line">	<span class="comment">//返回命令行参数后的其他参数</span></span><br><span class="line">	fmt.Println(flag.Args())</span><br><span class="line">	<span class="comment">//返回命令行参数后的其他参数个数</span></span><br><span class="line">	fmt.Println(flag.NArg())</span><br><span class="line">	<span class="comment">//返回使用的命令行参数个数</span></span><br><span class="line">	fmt.Println(flag.NFlag())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h5><p>命令行参数使用提示：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ ./flag_demo -<span class="built_in">help</span></span><br><span class="line">Usage of ./flag_demo:</span><br><span class="line">  -age int</span><br><span class="line">        年龄 (default 18)</span><br><span class="line">  -d duration</span><br><span class="line">        时间间隔</span><br><span class="line">  -married</span><br><span class="line">        婚否</span><br><span class="line">  -name string</span><br><span class="line">        姓名 (default <span class="string">&quot;张三&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>正常使用命令行flag参数：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ./flag_demo -name 沙河娜扎 --age 28 -married=<span class="literal">false</span> -d=1h30m</span><br><span class="line">沙河娜扎 28 <span class="literal">false</span> 1h30m0s</span><br><span class="line">[]</span><br><span class="line">0</span><br><span class="line">4</span><br></pre></td></tr></table></figure>

<p>使用非flag命令行参数：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ./flag_demo a b c</span><br><span class="line">张三 18 <span class="literal">false</span> 0s</span><br><span class="line">[a b c]</span><br><span class="line">3</span><br><span class="line">0</span><br></pre></td></tr></table></figure>




<h2 id="Log-包"><a href="#Log-包" class="headerlink" title="Log 包"></a>Log 包</h2><p>日志相关，<a href="ttps://blog.csdn.net/cold___play/article/details/130744302">参考</a></p>
<h3 id="基本结构"><a href="#基本结构" class="headerlink" title="基本结构"></a>基本结构</h3><p>常量列表：</p>
<ul>
<li>Ldate         日期 年&#x2F;月&#x2F;日</li>
<li>Ltime         时间 时:分:秒</li>
<li>Lmicroseconds 时间 .毫秒于Ltime之后</li>
<li>Llongfile     完整文件名:行号</li>
<li>Lshortfile    文件名，此标志位优先于 Llongfile</li>
<li>LstdFlags     &#x3D; Ldate 并且 Ltime</li>
</ul>
<p>功能说明：标志位常量控制日志格式。</p>
<p>示例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	log.SetFlags(log.Lshortfile | log.LstdFlags)</span><br><span class="line">	log.Println(<span class="string">&quot;log:&quot;</span>) <span class="comment">//2023/05/18 12:09:57 constantsDemo.go:15: log:</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>函数列表:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Fatal</span><span class="params">(v ...<span class="keyword">interface</span>&#123;&#125;)</span></span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Fatalf</span><span class="params">(format <span class="type">string</span>, v ...<span class="keyword">interface</span>&#123;&#125;)</span></span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Fatalln</span><span class="params">(v ...<span class="keyword">interface</span>&#123;&#125;)</span></span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Flags</span><span class="params">()</span></span> <span class="type">int</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Panic</span><span class="params">(v ...<span class="keyword">interface</span>&#123;&#125;)</span></span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Panicf</span><span class="params">(format <span class="type">string</span>, v ...<span class="keyword">interface</span>&#123;&#125;)</span></span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Panicln</span><span class="params">(v ...<span class="keyword">interface</span>&#123;&#125;)</span></span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Prefix</span><span class="params">()</span></span> <span class="type">string</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Print</span><span class="params">(v ...<span class="keyword">interface</span>&#123;&#125;)</span></span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Printf</span><span class="params">(format <span class="type">string</span>, v ...<span class="keyword">interface</span>&#123;&#125;)</span></span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Println</span><span class="params">(v ...<span class="keyword">interface</span>&#123;&#125;)</span></span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SetFlags</span><span class="params">(flag <span class="type">int</span>)</span></span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SetOutput</span><span class="params">(w io.Writer)</span></span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SetPrefix</span><span class="params">(prefix <span class="type">string</span>)</span></span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">New</span><span class="params">(out io.Writer, prefix <span class="type">string</span>, flag <span class="type">int</span>)</span></span> *Logger</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *Logger)</span></span> Fatal(v ...<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *Logger)</span></span> Fatalf(format <span class="type">string</span>, v ...<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *Logger)</span></span> Fatalln(v ...<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *Logger)</span></span> Flags() <span class="type">int</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *Logger)</span></span> Output(calldepth <span class="type">int</span>, s <span class="type">string</span>) <span class="type">error</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *Logger)</span></span> Panic(v ...<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *Logger)</span></span> Panicf(format <span class="type">string</span>, v ...<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *Logger)</span></span> Panicln(v ...<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *Logger)</span></span> Prefix() <span class="type">string</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *Logger)</span></span> Print(v ...<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *Logger)</span></span> Printf(format <span class="type">string</span>, v ...<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *Logger)</span></span> Println(v ...<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *Logger)</span></span> SetFlags(flag <span class="type">int</span>)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *Logger)</span></span> SetPrefix(prefix <span class="type">string</span>)</span><br></pre></td></tr></table></figure>
<h3 id="自定义-logger"><a href="#自定义-logger" class="headerlink" title="自定义 logger:"></a>自定义 logger:</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">New</span><span class="params">(out io.Writer, prefix <span class="type">string</span>, flag <span class="type">int</span>)</span></span> *Logger</span><br></pre></td></tr></table></figure>
<p>参数列表：<br>    out 输出目标<br>    prefix 输出前缀<br>    flag 格式配置标识值<br>返回值：<br>    自定义的logger<br>功能说明：<br>    这个方法用来自定义logger，指定输出目标、格式等<br>示例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	l := log.New(os.Stderr, <span class="string">&quot;logger&quot;</span>, log.Ldate)</span><br><span class="line">	l.Println(<span class="string">&quot;log to stderr sample&quot;</span>)<span class="comment">//logger2023/05/18 log to stderr sample</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Fatal系列函数"><a href="#Fatal系列函数" class="headerlink" title="Fatal系列函数"></a>Fatal系列函数</h3><h4 id="1-1-func-Fatal-v-…interface"><a href="#1-1-func-Fatal-v-…interface" class="headerlink" title="1.1 func Fatal(v …interface{})"></a>1.1 func Fatal(v …interface{})</h4><p>参数列表：<br>    v 待输出参数列表<br>返回值：<br>    无<br>功能说明：<br>    打印日志并退出。相当于调用Print()并os.Exit(1)</p>
<h4 id="1-2-func-Fatalf-format-string-v-…interface"><a href="#1-2-func-Fatalf-format-string-v-…interface" class="headerlink" title="1.2 func Fatalf(format string, v …interface{})"></a>1.2 func Fatalf(format string, v …interface{})</h4><p>参数列表：<br>    format 输出格式<br>    v 带输出参数列表<br>返回值：<br>    无<br>功能说明：<br>    按格式输出日志，并退出。相当于调用Printf()并调用os.Exit(1)</p>
<h4 id="1-3-func-Fatalln-v-…interface"><a href="#1-3-func-Fatalln-v-…interface" class="headerlink" title="1.3 func Fatalln(v …interface{})"></a>1.3 func Fatalln(v …interface{})</h4><p>参数列表：<br>    v<br>返回值：<br>    无<br>功能说明：<br>    打印一行日志并退出。相当于调用Println()并os.Exit(1)</p>
<h4 id="1-4-func-l-Logger-Fatal-v-…interface"><a href="#1-4-func-l-Logger-Fatal-v-…interface" class="headerlink" title="1.4 func (l *Logger) Fatal(v …interface{})"></a>1.4 func (l *Logger) Fatal(v …interface{})</h4><p>参数列表：<br>    v 待输出参数列表<br>返回值：<br>    无<br>功能说明：<br>    打印日志并退出。相当于调用l.Print()并os.Exit(1)</p>
<h4 id="1-5-func-Fatalf-format-string-v-…interface"><a href="#1-5-func-Fatalf-format-string-v-…interface" class="headerlink" title="1.5 func Fatalf(format string, v …interface{})"></a>1.5 func Fatalf(format string, v …interface{})</h4><p>参数列表：<br>    format 输出格式<br>    v 带输出参数列表<br>返回值：<br>    无<br>功能说明：<br>    按格式输出日志，并退出。相当于调用l.Printf()并调用os.Exit(1)</p>
<h4 id="1-6-func-l-Logger-Fatalln-v-…interface"><a href="#1-6-func-l-Logger-Fatalln-v-…interface" class="headerlink" title="1.6 func (l *Logger) Fatalln(v …interface{})"></a>1.6 func (l *Logger) Fatalln(v …interface{})</h4><p>参数列表：<br>    v<br>返回值：<br>    无<br>功能说明：<br>    打印一行日志并退出。相当于调用l.Println()并os.Exit(1)</p>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	age := <span class="number">25</span></span><br><span class="line">	log.Fatal(<span class="string">&quot;Hi &amp; Bye ! Age = &quot;</span>, age) <span class="comment">// this will print &quot;Hi &amp; Bye ! Age = 25&quot;</span></span><br><span class="line">	log.Println(<span class="string">&quot;This will not be called.&quot;</span>)</span><br><span class="line"></span><br><span class="line">	name := <span class="string">&quot;golang&quot;</span></span><br><span class="line">	log.Fatalf(<span class="string">&quot;%8d,%8s&quot;</span>, <span class="number">23</span>, name) <span class="comment">//2013/03/10 16:08:49       23,  golang</span></span><br><span class="line"></span><br><span class="line">	log.Fatalln(<span class="string">&quot;bye!&quot;</span>) <span class="comment">//2013/03/10 16:14:54 bye!\n</span></span><br><span class="line"></span><br><span class="line">	l := log.New(os.Stdout, <span class="string">&quot;&quot;</span>, log.LstdFlags)</span><br><span class="line">	age = <span class="number">25</span></span><br><span class="line">	l.Fatal(<span class="string">&quot;Hi &amp; Bye ! Age = &quot;</span>, age) <span class="comment">// this will print &quot;Hi &amp; Bye ! Age = 25&quot;</span></span><br><span class="line">	l.Println(<span class="string">&quot;This will not be called.&quot;</span>)</span><br><span class="line"></span><br><span class="line">	l = log.New(os.Stdout, <span class="string">&quot;&quot;</span>, log.LstdFlags)</span><br><span class="line">	<span class="comment">//l.Fatalf(&quot;%s&quot;, &quot;hello&quot;)</span></span><br><span class="line">	name = <span class="string">&quot;golang&quot;</span></span><br><span class="line">	l.Fatalf(<span class="string">&quot;%8d,%8s&quot;</span>, <span class="number">23</span>, name) <span class="comment">//2013/03/10 16:08:49       23,  golang</span></span><br><span class="line"></span><br><span class="line">	l = log.New(os.Stdout, <span class="string">&quot;&quot;</span>, log.LstdFlags)</span><br><span class="line">	l.Fatalln(<span class="string">&quot;bye!&quot;</span>) <span class="comment">//2013/03/10 16:14:54 bye!\n</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Flags系列函数"><a href="#Flags系列函数" class="headerlink" title="Flags系列函数"></a>Flags系列函数</h3><h4 id="2-1-func-Flags-int"><a href="#2-1-func-Flags-int" class="headerlink" title="2.1 func Flags() int"></a>2.1 func Flags() int</h4><p>参数列表：<br>    无<br>返回值：<br>    默认logger的配置值<br>功能说明：<br>    返回默认logger配置值。</p>
<h4 id="2-2-func-l-Logger-Flags-int"><a href="#2-2-func-l-Logger-Flags-int" class="headerlink" title="2.2 func (l *Logger) Flags() int"></a>2.2 func (l *Logger) Flags() int</h4><p>参数列表：<br>    无<br>返回值：<br>    当前logger的配置值<br>功能说明：<br>    返回当前logger配置值。</p>
<h4 id="2-3-func-SetFlags-flag-int"><a href="#2-3-func-SetFlags-flag-int" class="headerlink" title="2.3 func SetFlags(flag int)"></a>2.3 func SetFlags(flag int)</h4><p>参数列表：<br>    flag logger配置值<br>返回值：<br>    无<br>功能说明：<br>    这个方法用来设置标准logger的配置，默认为3（logger.LstdFlags）</p>
<h4 id="2-4-func-l-Logger-SetFlags-flag-int"><a href="#2-4-func-l-Logger-SetFlags-flag-int" class="headerlink" title="2.4 func (l *Logger) SetFlags(flag int)"></a>2.4 func (l *Logger) SetFlags(flag int)</h4><p>参数列表：<br>    flag logger配置值<br>返回值：<br>    无<br>功能说明：<br>    这个方法用来设置标准logger的配置，默认为3（logger.LstdFlags）</p>
<h4 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;standard flags :&quot;</span>, log.Flags()) <span class="comment">//standard flags : 3</span></span><br><span class="line">	<span class="comment">//the flags constants</span></span><br><span class="line">	fmt.Println(log.Ldate)         <span class="comment">//1</span></span><br><span class="line">	fmt.Println(log.Ltime)         <span class="comment">//2</span></span><br><span class="line">	fmt.Println(log.Lmicroseconds) <span class="comment">//4</span></span><br><span class="line">	fmt.Println(log.Llongfile)     <span class="comment">//8</span></span><br><span class="line">	fmt.Println(log.Lshortfile)    <span class="comment">//16</span></span><br><span class="line">	fmt.Println(log.LstdFlags)     <span class="comment">//LstdFlags     = Ldate | Ltime   3</span></span><br><span class="line"></span><br><span class="line">	l := log.New(os.Stdout, <span class="string">&quot;&quot;</span>, log.LstdFlags)</span><br><span class="line">	fmt.Println(<span class="string">&quot;logger l&#x27;s flags :&quot;</span>, l.Flags()) <span class="comment">//logger l&#x27;s flags : 3</span></span><br><span class="line"></span><br><span class="line">	log.Println(log.Flags()) <span class="comment">//2013/03/10 17:46:53 3</span></span><br><span class="line">	log.SetFlags(log.Ldate)</span><br><span class="line">	log.Println(log.Flags()) <span class="comment">//2013/03/10 1</span></span><br><span class="line">	log.SetFlags(log.LstdFlags | log.Lshortfile)</span><br><span class="line">	log.Println(log.Flags()) <span class="comment">//2013/03/10 17:46:53 setflags.go:17: 19</span></span><br><span class="line"></span><br><span class="line">	l = log.New(os.Stdout, <span class="string">&quot;&quot;</span>, log.LstdFlags)</span><br><span class="line">	l.Println(l.Flags()) <span class="comment">//2013/03/10 17:46:53 3</span></span><br><span class="line">	l.SetFlags(log.Ldate)</span><br><span class="line">	l.Println(l.Flags()) <span class="comment">//2013/03/10 1</span></span><br><span class="line">	l.SetFlags(log.LstdFlags | log.Lshortfile)</span><br><span class="line">	l.Println(l.Flags()) <span class="comment">//2013/03/10 17:46:53 setflags.go:17: 19</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Panic系列函数"><a href="#Panic系列函数" class="headerlink" title="Panic系列函数"></a>Panic系列函数</h3><h4 id="3-1-func-l-Logger-Panic-v-…interface"><a href="#3-1-func-l-Logger-Panic-v-…interface" class="headerlink" title="3.1 func (l *Logger) Panic(v …interface{})"></a>3.1 func (l *Logger) Panic(v …interface{})</h4><p>参数列表：<br>    v 待输出参数列表<br>返回值：<br>    无<br>功能说明：<br>    这个方法相当于调用l.Print()及panic()</p>
<h4 id="3-2-func-l-Logger-Panicf-format-string-v-…interface"><a href="#3-2-func-l-Logger-Panicf-format-string-v-…interface" class="headerlink" title="3.2 func (l *Logger) Panicf(format string, v …interface{})"></a>3.2 func (l *Logger) Panicf(format string, v …interface{})</h4><p>参数列表：<br>    format 输出格式<br>    v 待输出参数列表<br>返回值：<br>    无<br>功能说明：<br>    相当于调用l.Printf()，之后调用panic()</p>
<h4 id="3-3-func-l-Logger-Panicln-v-…interface"><a href="#3-3-func-l-Logger-Panicln-v-…interface" class="headerlink" title="3.3 func (l *Logger) Panicln(v …interface{})"></a>3.3 func (l *Logger) Panicln(v …interface{})</h4><p>参数列表：<br>    v 待输出参数列表<br>返回值：<br>    无<br>功能说明：<br>    相当于调用l.Println()并调用panic()</p>
<h4 id="3-4-func-Panic-v-…interface"><a href="#3-4-func-Panic-v-…interface" class="headerlink" title="3.4 func Panic(v …interface{})"></a>3.4 func Panic(v …interface{})</h4><p>参数列表：<br>    v 待输出参数列表<br>返回值：<br>    无<br>功能说明：<br>    这个方法相当于调用Print()及panic()</p>
<h4 id="3-5-func-Panicf-format-string-v-…interface"><a href="#3-5-func-Panicf-format-string-v-…interface" class="headerlink" title="3.5 func Panicf(format string, v …interface{})"></a>3.5 func Panicf(format string, v …interface{})</h4><p>参数列表：<br>    format 输出格式<br>    v 待输出参数列表<br>返回值：<br>    - 无<br>功能说明：<br>    相当于调用Printf()，之后调用panic()</p>
<h4 id="3-6-func-Panicln-v-…interface"><a href="#3-6-func-Panicln-v-…interface" class="headerlink" title="3.6 func Panicln(v …interface{})"></a>3.6 func Panicln(v …interface{})</h4><p>参数列表：<br>    v 待输出参数列表<br>返回值：<br>    无<br>功能说明：<br>    相当于调用Println()并调用panic()</p>
<h4 id="示例-2"><a href="#示例-2" class="headerlink" title="示例"></a>示例</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	l := log.New(os.Stdout, <span class="string">&quot;&quot;</span>, log.LstdFlags)</span><br><span class="line">	<span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(err) <span class="comment">//output : &quot;call panic and stop&quot;</span></span><br><span class="line">			handleException()</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line">	l.Panic(<span class="string">&quot;call panic and stop&quot;</span>)</span><br><span class="line">	log.Println(<span class="string">&quot;this will not be called.&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> err == <span class="string">&quot;3q&quot;</span> &#123;</span><br><span class="line">				log.Println(<span class="string">&quot;you are welcome&quot;</span>)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line">	l = log.New(os.Stdout, <span class="string">&quot;&quot;</span>, log.LstdFlags)</span><br><span class="line">	l.Panicf(<span class="string">&quot;%d%s&quot;</span>, <span class="number">3</span>, <span class="string">&quot;q&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> err == <span class="string">&quot;3q\n&quot;</span> &#123;</span><br><span class="line">				log.Println(<span class="string">&quot;you are welcome&quot;</span>)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line">	l = log.New(os.Stdout, <span class="string">&quot;&quot;</span>, log.LstdFlags)</span><br><span class="line">	l.Panicln(<span class="string">&quot;3q&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handleException</span><span class="params">()</span></span> &#123;</span><br><span class="line">	log.Println(<span class="string">&quot;recovering...&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Print系列函数"><a href="#Print系列函数" class="headerlink" title="Print系列函数"></a>Print系列函数</h3><h4 id="4-1-func-l-Logger-Print-v-…interface"><a href="#4-1-func-l-Logger-Print-v-…interface" class="headerlink" title="4.1 func (l *Logger) Print(v …interface{})"></a>4.1 func (l *Logger) Print(v …interface{})</h4><p>参数列表：<br>    v 待输出参数列表<br>返回值：<br>    无<br>功能说明：<br>    输出日志到logger。参数处理方式同fmt.Print</p>
<h4 id="4-2-func-l-Logger-Printf-format-string-v-…interface"><a href="#4-2-func-l-Logger-Printf-format-string-v-…interface" class="headerlink" title="4.2 func (l *Logger) Printf(format string, v …interface{})"></a>4.2 func (l *Logger) Printf(format string, v …interface{})</h4><p>参数列表：<br>    format 输出格式<br>    v 待输出参数列表<br>返回值：<br>    无<br>功能说明：<br>    调用l.Output输出日志到logger l。参数处理方式同fmt.Printf</p>
<h4 id="4-3-func-l-Logger-Println-v-…interface"><a href="#4-3-func-l-Logger-Println-v-…interface" class="headerlink" title="4.3 func (l *Logger) Println(v …interface{})"></a>4.3 func (l *Logger) Println(v …interface{})</h4><p>参数列表：<br>    v 待输出参数列表<br>返回值：<br>    无<br>功能说明：<br>    调用Output打印日志到当前logger，参数处理方式同fmt.Println</p>
<h4 id="4-4-func-Print-v-…interface"><a href="#4-4-func-Print-v-…interface" class="headerlink" title="4.4 func Print(v …interface{})"></a>4.4 func Print(v …interface{})</h4><p>参数列表：<br>    v 待输出参数列表<br>返回值：<br>    无<br>功能说明：<br>    输出日志到标准logger。参数处理方式同fmt.Print</p>
<h4 id="4-5-func-Printf-format-string-v-…interface"><a href="#4-5-func-Printf-format-string-v-…interface" class="headerlink" title="4.5 func Printf(format string, v …interface{})"></a>4.5 func Printf(format string, v …interface{})</h4><p>参数列表：<br>    format 输出格式<br>    v 待输出参数列表<br>返回值：<br>    无<br>功能说明：<br>    调用Output输出日志到标准logger。参数处理方式同fmt.Printf</p>
<h4 id="4-6-func-Println-v-…interface"><a href="#4-6-func-Println-v-…interface" class="headerlink" title="4.6 func Println(v …interface{})"></a>4.6 func Println(v …interface{})</h4><p>参数列表：<br>    v<br>返回值：<br>    无<br>功能说明：<br>    调用Output打印日志到标准logger，参数处理方式同fmt.Println</p>
<h4 id="示例-3"><a href="#示例-3" class="headerlink" title="示例"></a>示例</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	l := log.New(os.Stdout, <span class="string">&quot;&quot;</span>, log.LstdFlags)</span><br><span class="line">	l.Print(<span class="string">&quot;string&quot;</span>, <span class="number">1</span>, <span class="number">2.3</span>) <span class="comment">//2013/03/10 17:26:06 string1 2.3</span></span><br><span class="line"></span><br><span class="line">	l = log.New(os.Stdout, <span class="string">&quot;&quot;</span>, log.LstdFlags)</span><br><span class="line">	l.Printf(<span class="string">&quot;%s&quot;</span>, <span class="string">&quot;hello&quot;</span>) <span class="comment">//hello</span></span><br><span class="line">	name := <span class="string">&quot;golang&quot;</span></span><br><span class="line">	l.Printf(<span class="string">&quot;%8d,%8s&quot;</span>, <span class="number">23</span>, name) <span class="comment">//2013/03/10 16:08:49       23,  golang</span></span><br><span class="line"></span><br><span class="line">	l = log.New(os.Stdout, <span class="string">&quot;&quot;</span>, log.LstdFlags)</span><br><span class="line">	l.Println(<span class="string">&quot;hello&quot;</span>) <span class="comment">//2013/03/10 17:35:28 hello\n</span></span><br><span class="line"></span><br><span class="line">	log.Print(<span class="string">&quot;string&quot;</span>, <span class="number">1</span>, <span class="number">2.3</span>) <span class="comment">//2013/03/10 17:26:06 string1 2.3</span></span><br><span class="line"></span><br><span class="line">	log.Printf(<span class="string">&quot;%s&quot;</span>, <span class="string">&quot;hello&quot;</span>) <span class="comment">//hello</span></span><br><span class="line">	name = <span class="string">&quot;golang&quot;</span></span><br><span class="line">	log.Printf(<span class="string">&quot;%8d,%8s&quot;</span>, <span class="number">23</span>, name) <span class="comment">//2013/03/10 16:08:49       23,  golang</span></span><br><span class="line"></span><br><span class="line">	log.Println(<span class="string">&quot;hello&quot;</span>) <span class="comment">//2013/03/10 17:35:28 hello\n</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="其它函数"><a href="#其它函数" class="headerlink" title="其它函数"></a>其它函数</h3><h4 id="5-1-func-l-Logger-Prefix-string"><a href="#5-1-func-l-Logger-Prefix-string" class="headerlink" title="5.1 func (l *Logger) Prefix() string"></a>5.1 func (l *Logger) Prefix() string</h4><p>参数列表：<br>    无<br>返回值：<br>    logger前缀，字符串类型<br>功能说明：<br>    返回当前logger的输出前缀</p>
<h4 id="5-2-func-Prefix-string"><a href="#5-2-func-Prefix-string" class="headerlink" title="5.2 func Prefix() string"></a>5.2 func Prefix() string</h4><p>参数列表：<br>    无<br>返回值：<br>    标准logger前缀，字符串类型<br>功能说明：<br>    返回标准logger的输出前缀</p>
<h4 id="5-3-func-SetPrefix-prefix-string"><a href="#5-3-func-SetPrefix-prefix-string" class="headerlink" title="5.3 func SetPrefix(prefix string)"></a>5.3 func SetPrefix(prefix string)</h4><p>参数列表：<br>    prefix 前缀<br>返回值：<br>    无<br>功能说明：<br>    设置logger的输出前缀</p>
<h4 id="5-4-func-SetPrefix-prefix-string"><a href="#5-4-func-SetPrefix-prefix-string" class="headerlink" title="5.4 func SetPrefix(prefix string)"></a>5.4 func SetPrefix(prefix string)</h4><p>参数列表：<br>    prefix 前缀<br>返回值：<br>    无<br>功能说明：<br>    设置logger的输出前缀</p>
<h4 id="5-5-func-l-Logger-Output-calldepth-int-s-string-error"><a href="#5-5-func-l-Logger-Output-calldepth-int-s-string-error" class="headerlink" title="5.5 func (l *Logger) Output(calldepth int, s string) error"></a>5.5 func (l *Logger) Output(calldepth int, s string) error</h4><p>参数列表：<br>    calldepth 深度<br>    s 字符串<br>返回值：<br>    error 错误<br>功能说明：<br>    输出日志事件。字符串s包含待打印内容，跟在预定义的prefix后面，并且根据flags设置会有区分。如果s末尾没有换行符，这个方法会默认加上一个。calldepth目前预定义均为2,以后会用来支持通用场景，支持其他值配置。（本人注：日志输出不建议直接使用该方法）</p>
<h4 id="5-6-func-SetOutput-w-io-Writer"><a href="#5-6-func-SetOutput-w-io-Writer" class="headerlink" title="5.6 func SetOutput(w io.Writer)"></a>5.6 func SetOutput(w io.Writer)</h4><p>参数列表：<br>    w 目标流，io.Writer类型<br>返回值：<br>    无<br>功能说明：<br>    设置标准logger的输出目标</p>
<h4 id="示例-4"><a href="#示例-4" class="headerlink" title="示例"></a>示例</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	l := log.New(os.Stdout, <span class="string">&quot;&quot;</span>, log.LstdFlags)</span><br><span class="line">	fmt.Print(l.Prefix()) <span class="comment">//this will print nothing</span></span><br><span class="line">	l.Println(<span class="number">1</span>)          <span class="comment">//2013/03/10 17:02:05 1</span></span><br><span class="line">	l.SetPrefix(<span class="string">&quot;log:&quot;</span>)</span><br><span class="line">	fmt.Println(l.Prefix()) <span class="comment">//log:</span></span><br><span class="line">	l.Println(<span class="number">2</span>)            <span class="comment">//log:2013/03/10 17:02:05 2</span></span><br><span class="line"></span><br><span class="line">	fmt.Print(log.Prefix()) <span class="comment">//this will print nothing</span></span><br><span class="line">	log.Println(<span class="number">1</span>)          <span class="comment">//2013/03/10 17:02:05 1</span></span><br><span class="line">	log.SetPrefix(<span class="string">&quot;log:&quot;</span>)</span><br><span class="line">	fmt.Println(log.Prefix()) <span class="comment">//log:</span></span><br><span class="line">	log.Println(<span class="number">2</span>)            <span class="comment">//log:2013/03/10 17:02:05 2</span></span><br><span class="line"></span><br><span class="line">	l = log.New(os.Stdout, <span class="string">&quot;&quot;</span>, log.LstdFlags)</span><br><span class="line">	fmt.Print(l.Prefix()) <span class="comment">//this will print nothing</span></span><br><span class="line">	l.Println(<span class="number">1</span>)          <span class="comment">//2013/03/10 17:02:05 1</span></span><br><span class="line">	l.SetPrefix(<span class="string">&quot;log:&quot;</span>)</span><br><span class="line">	fmt.Println(l.Prefix()) <span class="comment">//log:</span></span><br><span class="line"></span><br><span class="line">	l.Println(<span class="number">2</span>) <span class="comment">//log:2013/03/10 17:02:05 2</span></span><br><span class="line"></span><br><span class="line">	fmt.Print(log.Prefix()) <span class="comment">//this will print nothing</span></span><br><span class="line">	log.Println(<span class="number">1</span>)          <span class="comment">//2013/03/10 17:02:05 1</span></span><br><span class="line">	log.SetPrefix(<span class="string">&quot;log:&quot;</span>)</span><br><span class="line">	fmt.Println(log.Prefix()) <span class="comment">//log:</span></span><br><span class="line">	log.Println(<span class="number">2</span>)            <span class="comment">//log:2013/03/10 17:02:05 2</span></span><br><span class="line"></span><br><span class="line">	l = log.New(os.Stdout, <span class="string">&quot;log-&gt;&quot;</span>, log.Ldate)</span><br><span class="line">	l.Output(<span class="number">2</span>, <span class="string">&quot;log output&quot;</span>)</span><br><span class="line"></span><br><span class="line">	file, err := os.OpenFile(<span class="string">&quot;sample.txt&quot;</span>, os.O_WRONLY, <span class="number">0666</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> file.Close()</span><br><span class="line">	log.SetOutput(file)</span><br><span class="line">	log.Println(<span class="string">&quot;log to file&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Badger-包"><a href="#Badger-包" class="headerlink" title="Badger 包"></a>Badger 包</h2><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903814571491335">参考</a><br><a target="_blank" rel="noopener" href="https://pkg.go.dev/github.com/dgraph-io/badger#Txn">官方文档</a><br>badger是一个纯Go实现的快速的嵌入式K&#x2F;V数据库，针对LSM tree做了优化。</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p><code>$ go get github.com/dgraph-io/badger/...</code></p>
<h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><p>打开一个数据库</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">opts := badger.DefaultOptions</span><br><span class="line">opts.Dir = <span class="string">&quot;/tmp/badger&quot;</span> </span><br><span class="line">opts.ValueDir = <span class="string">&quot;/tmp/badger&quot;</span> </span><br><span class="line">db, err := badger.Open(opts) </span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	log.Fatal(err) </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">defer</span> db.Close()</span><br></pre></td></tr></table></figure>
<h3 id="存储"><a href="#存储" class="headerlink" title="存储"></a>存储</h3><h4 id="存储kv"><a href="#存储kv" class="headerlink" title="存储kv"></a>存储kv</h4><p>使用 Txn.Set()方法</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">err := db.Update(<span class="function"><span class="keyword">func</span><span class="params">(txn *badger.Txn)</span></span> <span class="type">error</span> &#123;   </span><br><span class="line">	err := txn.Set([]<span class="type">byte</span>(<span class="string">&quot;answer&quot;</span>), []<span class="type">byte</span>(<span class="string">&quot;42&quot;</span>))   </span><br><span class="line">	<span class="keyword">return</span> err </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="批量设置"><a href="#批量设置" class="headerlink" title="批量设置"></a>批量设置</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wb := db.NewWriteBatch() </span><br><span class="line"><span class="keyword">defer</span> wb.Cancel() </span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; N; i++ &#123;</span><br><span class="line">	err := wb.Set(key(i), value(i), <span class="number">0</span>) <span class="comment">// Will create txns as needed. </span></span><br><span class="line">	handle(err) </span><br><span class="line">&#125; </span><br><span class="line">handle(wb.Flush()) <span class="comment">// Wait for all txns to finish.</span></span><br></pre></td></tr></table></figure>
<p>WriteBatch不允许任何读取。对于读-修改-写，应该使用事务API。</p>
<h5 id="设置生存时间-TTL"><a href="#设置生存时间-TTL" class="headerlink" title="设置生存时间 TTL"></a>设置生存时间 TTL</h5><p>Badger 允许在键上设置一个可选的生存时间 (TTL) 值。一旦 TTL 结束，KEY 将不再是可检索的，并且将进行垃圾收集。TTL 可以使用 Txn.SetWithTTL() 设置为一个<code>time.Duration</code>的值</p>
<h5 id="设置元数据"><a href="#设置元数据" class="headerlink" title="设置元数据"></a>设置元数据</h5><p><code>Txn.SetWithMeta()</code> 设置用户元数据</p>
<p>使用 <code>Txn.SetEntry()</code> 可以一次性设置 key, value, user metatadata 和 TTL</p>
<h5 id="遍历-keys"><a href="#遍历-keys" class="headerlink" title="遍历 keys"></a>遍历 keys</h5><p>要遍历键，我们可以使用迭代器，可以使用 <code>Txn.NewIterator()</code>方法获得迭代器。迭代按字节字典排序顺序进行。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">err := db.View(<span class="function"><span class="keyword">func</span><span class="params">(txn *badger.Txn)</span></span> <span class="type">error</span> &#123; <span class="comment">// badger 的 view 方法创建一个只读事务</span></span><br><span class="line">	opts := badger.DefaultIteratorOptions   </span><br><span class="line">	opts.PrefetchSize = <span class="number">10</span>   </span><br><span class="line">	it := txn.NewIterator(opts)   </span><br><span class="line">	<span class="keyword">defer</span> it.Close()   </span><br><span class="line">	<span class="keyword">for</span> it.Rewind(); it.Valid(); it.Next() &#123;</span><br><span class="line">	    item := it.Item() </span><br><span class="line">	    k := item.Key()     </span><br><span class="line">	    err := item.Value(<span class="function"><span class="keyword">func</span><span class="params">(v []<span class="type">byte</span>)</span></span> <span class="type">error</span> &#123;</span><br><span class="line">	        fmt.Printf(<span class="string">&quot;key=%s, value=%s\n&quot;</span>, k, v)       </span><br><span class="line">	        <span class="keyword">return</span> <span class="literal">nil</span>     </span><br><span class="line">	        &#125;)     </span><br><span class="line">	    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;       </span><br><span class="line">		    <span class="keyword">return</span> err</span><br><span class="line">		&#125;   </span><br><span class="line">	&#125;   </span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span> </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h6 id="前缀扫描"><a href="#前缀扫描" class="headerlink" title="前缀扫描"></a>前缀扫描</h6><p>要遍历键前缀，可以将 Seek() 和 ValidForPrefix() 组合使用：（这里的前缀是键值的）</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">db.View(<span class="function"><span class="keyword">func</span><span class="params">(txn *badger.Txn)</span></span> <span class="type">error</span> &#123;</span><br><span class="line">	it := txn.NewIterator(badger.DefaultIteratorOptions)</span><br><span class="line">	<span class="keyword">defer</span> it.Close()   </span><br><span class="line">	prefix := []<span class="type">byte</span>(<span class="string">&quot;1234&quot;</span>)   </span><br><span class="line">	<span class="keyword">for</span> it.Seek(prefix); it.ValidForPrefix(prefix); it.Next() &#123;</span><br><span class="line">		item := it.Item()    </span><br><span class="line">		k := item.Key()     </span><br><span class="line">		err := item.Value(<span class="function"><span class="keyword">func</span><span class="params">(v []<span class="type">byte</span>)</span></span> <span class="type">error</span> &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;key=%s, value=%s\n&quot;</span>, k, v)       </span><br><span class="line">			<span class="keyword">return</span> <span class="literal">nil</span>     </span><br><span class="line">		&#125;)     </span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;       </span><br><span class="line">			<span class="keyword">return</span> err     </span><br><span class="line">		&#125;   </span><br><span class="line">	&#125;   </span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span> </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h6 id="键的遍历"><a href="#键的遍历" class="headerlink" title="键的遍历"></a>键的遍历</h6><p>Badger支持一种独特的迭代模式，称为只有键的迭代。它比常规迭代快几个数量级，因为它只涉及对 lsm 树的访问，而 lsm 树通常完全驻留在 RAM 中。要启用只有键的迭代，您需要设置 IteratorOptions 。PrefetchValues 字段为 false 。这还可以用于在迭代期间对选定的键执行稀疏读取，只在需要时调用 item.Value() 。(获取键，而不获取对应的值)</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">err := db.View(<span class="function"><span class="keyword">func</span><span class="params">(txn *badger.Txn)</span></span> <span class="type">error</span> &#123;   </span><br><span class="line">	opts := badger.DefaultIteratorOptions   </span><br><span class="line">	opts.PrefetchValues = <span class="literal">false</span>   </span><br><span class="line">	it := txn.NewIterator(opts)   </span><br><span class="line">	<span class="keyword">defer</span> it.Close()   </span><br><span class="line">	<span class="keyword">for</span> it.Rewind(); it.Valid(); it.Next() &#123;</span><br><span class="line">		item := it.Item()     </span><br><span class="line">		k := item.Key()     </span><br><span class="line">		fmt.Printf(<span class="string">&quot;key=%s\n&quot;</span>, k)   </span><br><span class="line">	&#125;   </span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span> </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="数据流"><a href="#数据流" class="headerlink" title="数据流"></a>数据流</h3><p>Badger 提供了一个流框架，它可以并发地遍历数据库的全部或部分，将数据转换为自定义键值，并连续地将数据流输出，以便通过网络发送、写入磁盘，甚至写入 Badger。这是比使用单个迭代器更快的遍历 Badger 的方法。Stream 在管理模式和正常模式下都支持Badger 。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">stream := db.NewStream() </span><br><span class="line"><span class="comment">// db.NewStreamAt(readTs) for managed mode. </span></span><br><span class="line"><span class="comment">// -- Optional settings </span></span><br><span class="line">stream.NumGo = <span class="number">16</span>          <span class="comment">// Set number of goroutines to use for iteration.</span></span><br><span class="line">stream.Prefix = []<span class="type">byte</span>(<span class="string">&quot;some-prefix&quot;</span>) <span class="comment">// Leave nil for iteration over the whole DB. </span></span><br><span class="line">stream.LogPrefix = <span class="string">&quot;Badger.Streaming&quot;</span> <span class="comment">// For identifying stream logs. Outputs to Logger. </span></span><br><span class="line"><span class="comment">// ChooseKey is called concurrently for every key. If left nil, assumes true by default. </span></span><br><span class="line">stream.ChooseKey = <span class="function"><span class="keyword">func</span><span class="params">(item *badger.Item)</span></span> <span class="type">bool</span> &#123;   </span><br><span class="line">	<span class="keyword">return</span> bytes.HasSuffix(item.Key(), []<span class="type">byte</span>(<span class="string">&quot;er&quot;</span>)) </span><br><span class="line">	<span class="comment">// 这个例子中判断后缀 “er” </span></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// KeyToList is called concurrently for chosen keys. This can be used to convert </span></span><br><span class="line"><span class="comment">// Badger data into custom key-values. If nil, uses stream.ToList, a default </span></span><br><span class="line"><span class="comment">// implementation, which picks all valid key-values. </span></span><br><span class="line">stream.KeyToList = <span class="literal">nil</span> </span><br><span class="line"><span class="comment">// -- End of optional settings. </span></span><br><span class="line"><span class="comment">// Send is called serially, while Stream.Orchestrate is running. 用于序列化并处理流操作的结果</span></span><br><span class="line">stream.Send = <span class="function"><span class="keyword">func</span><span class="params">(list *pb.KVList)</span></span> <span class="type">error</span> &#123;   </span><br><span class="line">	<span class="keyword">return</span> proto.MarshalText(w, list) <span class="comment">// Write to w. </span></span><br><span class="line">	&#125; </span><br><span class="line"><span class="comment">// Run the stream </span></span><br><span class="line"><span class="keyword">if</span> err := stream.Orchestrate(context.Background()); err != <span class="literal">nil</span> &#123;   </span><br><span class="line">	<span class="keyword">return</span> err </span><br><span class="line">&#125; <span class="comment">// Done.</span></span><br></pre></td></tr></table></figure>


<h3 id="删除一个key"><a href="#删除一个key" class="headerlink" title="删除一个key"></a>删除一个key</h3><p>使用<code>Txn.Delete()</code> 方法删除一个key</p>
<h3 id="获取-key-value"><a href="#获取-key-value" class="headerlink" title="获取 key value"></a>获取 key value</h3><p>通过 txn.Get 获取 value</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">err := db.View(<span class="function"><span class="keyword">func</span><span class="params">(txn *badger.Txn)</span></span> <span class="type">error</span> &#123;   </span><br><span class="line">	item, err := txn.Get([]<span class="type">byte</span>(<span class="string">&quot;answer&quot;</span>))   </span><br><span class="line">	handle(err)   </span><br><span class="line">	<span class="keyword">var</span> valNot, valCopy []<span class="type">byte</span>   </span><br><span class="line">	err := item.Value(<span class="function"><span class="keyword">func</span><span class="params">(val []<span class="type">byte</span>)</span></span> <span class="type">error</span> &#123;     </span><br><span class="line">	<span class="comment">// This func with val would only be called if item.Value encounters no error.     </span></span><br><span class="line">	<span class="comment">// Accessing val here is valid.     </span></span><br><span class="line">	fmt.Printf(<span class="string">&quot;The answer is: %s\n&quot;</span>, val)     </span><br><span class="line">	<span class="comment">// Copying or parsing val is valid.     </span></span><br><span class="line">	valCopy = <span class="built_in">append</span>([]<span class="type">byte</span>&#123;&#125;, val...)     <span class="comment">// 三个点（`...`）的语法，表示将切片 `val` 展开，将其中的元素逐个添加到新的切片 `valCopy` 中。</span></span><br><span class="line">	<span class="comment">// Assigning val slice to another variable is NOT OK.     </span></span><br><span class="line">	valNot = val <span class="comment">// Do not do this.     </span></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span>   </span><br><span class="line">&#125;)   </span><br><span class="line">handle(err)   <span class="comment">// DO NOT access val here. It is the most common cause of bugs.</span></span><br><span class="line">fmt.Printf(<span class="string">&quot;NEVER do this. %s\n&quot;</span>, valNot)   </span><br><span class="line"><span class="comment">// You must copy it to use it outside item.Value(...).   </span></span><br><span class="line">fmt.Printf(<span class="string">&quot;The answer is: %s\n&quot;</span>, valCopy)   </span><br><span class="line"><span class="comment">// Alternatively, you could also use item.ValueCopy().   </span></span><br><span class="line">valCopy, err = item.ValueCopy(<span class="literal">nil</span>)   </span><br><span class="line">handle(err)   </span><br><span class="line">fmt.Printf(<span class="string">&quot;The answer is: %s\n&quot;</span>, valCopy)   </span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span> </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>如果不存在 <code>Txn.Get()</code> 将会返回一个 <code>ErrKeyNotFound</code> 错误</p>
<p>请注意，Get()返回的值只在事务打开时有效。如果需要在事务外部使用值，则必须使用copy() 将其复制到另一个字节片。</p>
<h3 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h3><h5 id="只读事务"><a href="#只读事务" class="headerlink" title="只读事务"></a>只读事务</h5><p>只读事务使用 DB.View()方法</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">err := db.View(<span class="function"><span class="keyword">func</span><span class="params">(txn *badger.Txn)</span></span> <span class="type">error</span> &#123;  </span><br><span class="line">	<span class="comment">// Your code here…   </span></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span> </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="读写事务锁"><a href="#读写事务锁" class="headerlink" title="读写事务锁"></a>读写事务锁</h5><p>读写事务可以使用 DB.Update()方法</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">err := db.Update(<span class="function"><span class="keyword">func</span><span class="params">(txn *badger.Txn)</span></span> <span class="type">error</span> &#123;   </span><br><span class="line">	<span class="comment">// Your code here…   </span></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span> </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="手动管理事务"><a href="#手动管理事务" class="headerlink" title="手动管理事务"></a>手动管理事务</h5><p>直接使用<code>DB.NewTransaction()</code>函数，手动创建和提交事务。它接受一个布尔参数来指定是否需要读写事务。对于读写事务，需要调用<code>Txn.Commit()</code>来确保事务已提交。对于只读事务，调用 <code>txn.reject()</code>就可以了。<code>commit()</code>也在内部调用 <code>txn .reject()</code>来清除事务，因此只需调用Txn.Commit()就足以执行读写事务。</p>
<p>但是，如果您的代码由于某种原因(出错)没有调用<code>Txn.Commit()</code>。就需要在defer中调用 <code>txn . reject()</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Start a writable transaction. </span></span><br><span class="line">txn := db.NewTransaction(<span class="literal">true</span>) </span><br><span class="line"><span class="keyword">defer</span> txn.Discard() </span><br><span class="line"><span class="comment">// Use the transaction... </span></span><br><span class="line">err := txn.Set([]<span class="type">byte</span>(<span class="string">&quot;answer&quot;</span>), []<span class="type">byte</span>(<span class="string">&quot;42&quot;</span>)) </span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;     <span class="keyword">return</span> err &#125; </span><br><span class="line"><span class="comment">// Commit the transaction and check for error. </span></span><br><span class="line"><span class="keyword">if</span> err := txn.Commit(); err != <span class="literal">nil</span> &#123;     </span><br><span class="line">	<span class="keyword">return</span> err </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Error-包"><a href="#Error-包" class="headerlink" title="Error 包"></a>Error 包</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个新 的 error 类型 数据</span></span><br><span class="line">errors.New(<span class="string">&quot;dest id is not cur id&quot;</span>) </span><br></pre></td></tr></table></figure>

<h2 id="Server-常用"><a href="#Server-常用" class="headerlink" title="Server 常用"></a>Server 常用</h2><ol>
<li><p>获取 URL 的路径参数</p>
<p>   比如： 前端访问：<a target="_blank" rel="noopener" href="http://127.0.0.1:8080/haha">http://127.0.0.1:8080/haha</a> ， 如何获取 haha 这个字符串？ 看代码：</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">        <span class="string">&quot;fmt&quot;</span></span><br><span class="line">        <span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func handler(w http.ResponseWriter, r *http.Request) &#123;</span><br><span class="line">        // 从请求URL中获取路径参数</span><br><span class="line">        param := r.URL.Path[len(<span class="string">&quot;/&quot;</span>):]</span><br><span class="line"></span><br><span class="line">        // 输出获取到的字符串</span><br><span class="line">        fmt.Println(param)</span><br><span class="line"></span><br><span class="line">        // 在响应中返回获取到的字符串</span><br><span class="line">        fmt.Fprintf(w, <span class="string">&quot;Received: %s&quot;</span>, param)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func <span class="function"><span class="title">main</span></span>() &#123;</span><br><span class="line">        http.HandleFunc(<span class="string">&quot;/&quot;</span>, handler)</span><br><span class="line">        http.ListenAndServe(<span class="string">&quot;:80&quot;</span>, nil)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>http 状态码返回</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">        <span class="string">&quot;fmt&quot;</span></span><br><span class="line">        <span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line">func handleRequest(w http.ResponseWriter, r *http.Request) &#123;</span><br><span class="line">        // 模拟根据请求处理的逻辑</span><br><span class="line">        <span class="keyword">if</span> r.URL.Path == <span class="string">&quot;/&quot;</span> &#123;</span><br><span class="line">                // 处理成功，返回HTTP 200</span><br><span class="line">                w.WriteHeader(http.StatusOK)</span><br><span class="line">                fmt.Fprintf(w, <span class="string">&quot;Success&quot;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                // 处理失败，返回HTTP 404</span><br><span class="line">                w.WriteHeader(http.StatusNotFound)</span><br><span class="line">                fmt.Fprintf(w, <span class="string">&quot;Not Found&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">func <span class="function"><span class="title">main</span></span>() &#123;</span><br><span class="line">        http.HandleFunc(<span class="string">&quot;/&quot;</span>, handleRequest)</span><br><span class="line">        http.ListenAndServe(<span class="string">&quot;:80&quot;</span>, nil)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>闭包</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">在Go语言中，http.HandleFunc()函数的第二个参数是一个函数类型，它必须是满足http.HandlerFunc函数签名的函数。该函数接收两个参数：http.ResponseWriter和*http.Request。</span><br><span class="line">如果你想在handleRequest函数中传入其他参数，可以使用闭包（Closure）的方式。</span><br><span class="line">以下是一个示例代码，展示如何在handleRequest函数中传入其他参数：</span><br><span class="line">go</span><br><span class="line">复制</span><br><span class="line">package main</span><br><span class="line">import (</span><br><span class="line">        <span class="string">&quot;fmt&quot;</span></span><br><span class="line">        <span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func handleRequest(customParam string) http.HandlerFunc &#123;</span><br><span class="line">        <span class="built_in">return</span> func(w http.ResponseWriter, r *http.Request) &#123;</span><br><span class="line">                // 在这里可以使用 customParam 和 w、r 来处理请求</span><br><span class="line">                fmt.Println(<span class="string">&quot;Custom parameter:&quot;</span>, customParam)</span><br><span class="line">                fmt.Fprintf(w, <span class="string">&quot;Hello, World!&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func <span class="function"><span class="title">main</span></span>() &#123;</span><br><span class="line">        param := <span class="string">&quot;custom value&quot;</span></span><br><span class="line">        http.HandleFunc(<span class="string">&quot;/&quot;</span>, handleRequest(param))</span><br><span class="line">        http.ListenAndServe(<span class="string">&quot;:8080&quot;</span>, nil)</span><br><span class="line">&#125;</span><br><span class="line">在上述代码中，我们定义了一个handleRequest函数，它接收一个类型为string的参数customParam。handleRequest函数返回一个函数，该函数满足http.HandlerFunc函数签名。</span><br><span class="line">在返回的函数中，我们可以使用闭包的方式访问customParam以及http.ResponseWriter和*http.Request参数，并进行相应的处理。</span><br><span class="line">在main函数中，我们定义了一个param变量作为自定义参数的值。然后，我们通过handleRequest(param)将param传递给handleRequest函数，并返回一个满足http.HandlerFunc函数签名的函数。</span><br><span class="line">最后，我们使用http.HandleFunc()来将路径<span class="string">&quot;/&quot;</span>与返回的处理函数进行绑定，并通过http.ListenAndServe()监听HTTP请求</span><br></pre></td></tr></table></figure>
</li>
<li><p>net 和 http同时使用</p>
<p>   Go 语言中，可以同时使用 <code>net</code> 和 <code>http</code> 包来监听同一个接口，但是需要小心处理并避免冲突。</p>
<p>   <code>net</code> 包提供了底层的网络功能，可以通过 <code>net.Listen</code> 函数来监听指定的网络地址和端口。而 <code>http</code> 包是建立在 <code>net</code> 包之上的，提供了更高级的 HTTP 服务器和客户端功能。</p>
<p>   以下是一个示例代码，同时使用 <code>net</code> 和 <code>http</code> 监听同一个接口：</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line">import (</span><br><span class="line">        &quot;fmt&quot;</span><br><span class="line">        &quot;net&quot;</span><br><span class="line">        &quot;net/http&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">        // 使用 net 包监听指定的网络地址和端口</span><br><span class="line">        listener, err := net.Listen(&quot;tcp&quot;, &quot;localhost:8080&quot;)</span><br><span class="line">        if err != nil &#123;</span><br><span class="line">                fmt.Println(&quot;Error listening:&quot;, err)</span><br><span class="line">                return</span><br><span class="line">        &#125;</span><br><span class="line">        defer listener.Close()</span><br><span class="line">        // 启动 HTTP 服务器</span><br><span class="line">        go func() &#123;</span><br><span class="line">                http.HandleFunc(&quot;/&quot;, func(w http.ResponseWriter, r *http.Request) &#123;</span><br><span class="line">                        fmt.Fprintf(w, &quot;Hello, HTTP!&quot;)</span><br><span class="line">                &#125;)</span><br><span class="line">                err := http.Serve(listener, nil)</span><br><span class="line">                if err != nil &#123;</span><br><span class="line">                        fmt.Println(&quot;Error serving HTTP:&quot;, err)</span><br><span class="line">                        return</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;()</span><br><span class="line"></span><br><span class="line">        // 其他的网络处理逻辑...</span><br><span class="line">        // ...</span><br><span class="line">        // 等待程序退出</span><br><span class="line">        select &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>   在上述示例中，我们使用 <code>net.Listen</code> 函数监听 <code>localhost:8080</code>，然后使用 <code>http</code> 包启动了一个 HTTP 服务器。通过 <code>http.HandleFunc</code> 函数，我们定义了一个简单的处理函数来响应 HTTP 请求。最后，通过 <code>http.Serve</code> 函数将监听器与 HTTP 服务器关联起来。</p>
<p>   你可以在 <code>// 其他的网络处理逻辑...</code> 的部分添加其他网络处理逻辑，如基于 <code>net</code> 包的 TCP 或 UDP 服务器。只需确保网络处理逻辑不会与 HTTP 服务器冲突，比如使用不同的端口或处理不同的网络协议。</p>
<p>   需要注意的是，当使用 <code>http.Serve</code> 函数时，它将阻塞当前的 goroutine，因此我们在示例中使用了 <code>select &#123;&#125;</code> 来阻止 <code>main</code> 函数退出。这样可以保持服务器的运行，直到显式地退出程序。</p>
</li>
<li><p>mymux</p>
<p>   <code>myMux := http.NewServeMux()</code> 这条语句用于创建一个新的 <code>ServeMux</code> 对象。</p>
<p>   在 Go 的 <code>http</code> 包中，<code>ServeMux</code> 是一个 HTTP 请求多路复用器（multiplexer），用于将收到的 HTTP 请求分发到相应的处理器。<code>ServeMux</code> 类型实现了 <code>http.Handler</code> 接口，因此它本身可以作为一个处理器来处理请求。</p>
<p>   通过调用 <code>http.NewServeMux()</code> 函数，我们可以创建一个新的 <code>ServeMux</code> 对象，它将用于注册和管理不同路径的处理器。</p>
<p>   例如，下面是一个简单示例，使用 <code>ServeMux</code> 对象来管理不同路径的处理器：</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line">import (</span><br><span class="line">        &quot;fmt&quot;</span><br><span class="line">        &quot;net/http&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">        myMux := http.NewServeMux()</span><br><span class="line"></span><br><span class="line">        myMux.HandleFunc(&quot;/&quot;, func(w http.ResponseWriter, r *http.Request) &#123;</span><br><span class="line">                fmt.Fprintf(w, &quot;Hello, World!&quot;)</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        myMux.HandleFunc(&quot;/about&quot;, func(w http.ResponseWriter, r *http.Request) &#123;</span><br><span class="line">                fmt.Fprintf(w, &quot;About page&quot;)</span><br><span class="line">        &#125;)</span><br><span class="line">        server := &amp;http.Server&#123;</span><br><span class="line">                Addr:    &quot;:8080&quot;,</span><br><span class="line">                Handler: myMux,</span><br><span class="line">        &#125;</span><br><span class="line">        server.ListenAndServe()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>   在上述示例中，我们首先使用 <code>http.NewServeMux()</code> 创建了一个新的 <code>ServeMux</code> 对象 <code>myMux</code>。然后，我们使用 <code>myMux.HandleFunc</code> 方法来注册处理器函数，每个函数对应一个特定的路径。</p>
<p>   最后，我们创建了一个 <code>http.Server</code> 对象，并将 <code>myMux</code> 对象作为处理器指定给该服务器。这样，当服务器收到请求时，就会使用 <code>myMux</code> 对象来根据请求的路径选择相应的处理器函数进行处理。</p>
<p>   总结起来，<code>myMux := http.NewServeMux()</code> 用于创建一个 <code>ServeMux</code> 对象，以便注册和管理不同路径的处理器，并根据路径选择相应的处理函数来处理请求。</p>
</li>
<li><p>go routine 实现并发执行</p>
<p>   Go 的 goroutine 来实现并发执行。以下是一个示例代码，演示了如何同时运行 HTTP 服务、gRPC 服务和连接其他 gRPC 服务器：</p>
 <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">        <span class="string">&quot;log&quot;</span></span><br><span class="line">        <span class="string">&quot;net&quot;</span></span><br><span class="line">        <span class="string">&quot;net/http&quot;</span></span><br><span class="line">        <span class="string">&quot;google.golang.org/grpc&quot;</span></span><br><span class="line">        <span class="string">&quot;google.golang.org/grpc/credentials&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">// 创建监听器</span></span><br><span class="line">        lis, err := net.Listen(<span class="string">&quot;tcp&quot;</span>, <span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">                log.Fatalf(<span class="string">&quot;Failed to listen: %v&quot;</span>, err)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 启动 HTTP 服务器</span></span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">                http.HandleFunc(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">                        w.Write([]<span class="type">byte</span>(<span class="string">&quot;Hello, HTTP!&quot;</span>))</span><br><span class="line">                &#125;)</span><br><span class="line">                <span class="keyword">if</span> err := http.Serve(lis, <span class="literal">nil</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line">                        log.Fatalf(<span class="string">&quot;HTTP failed to serve: %v&quot;</span>, err)</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;()</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 启动 gRPC 服务器</span></span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">                s := grpc.NewServer()</span><br><span class="line">                <span class="comment">// 注册 gRPC 服务</span></span><br><span class="line">                <span class="comment">// ...</span></span><br><span class="line">                <span class="keyword">if</span> err := s.Serve(lis); err != <span class="literal">nil</span> &#123;</span><br><span class="line">                        log.Fatalf(<span class="string">&quot;gRPC failed to serve: %v&quot;</span>, err)</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;()</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 连接其他 gRPC 服务器</span></span><br><span class="line">        conn, err := grpc.Dial(<span class="string">&quot;other_server_address&quot;</span>, grpc.WithTransportCredentials(credentials.NewInsecure()))</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">                log.Fatalf(<span class="string">&quot;Failed to connect to other server: %v&quot;</span>, err)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">defer</span> conn.Close()</span><br><span class="line">        <span class="comment">// 进行其他操作，使用 conn 进行 gRPC 通信</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        <span class="comment">// 等待程序退出</span></span><br><span class="line">        <span class="keyword">select</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>   在这个示例中，我们使用 goroutine 启动了 HTTP 服务器和 gRPC 服务器，并在主函数中创建了一个与其他 gRPC 服务器的连接。</p>
<p>   注意在连接其他 gRPC 服务器时，我们使用了 <code>grpc.Dial</code> 函数，并传递了 <code>grpc.WithTransportCredentials(credentials.NewInsecure())</code> 选项来创建一个不安全的连接。你应该根据实际情况选择正确的连接配置，例如使用安全的连接和认证。</p>
<p>   最后，使用 <code>select &#123;&#125;</code> 阻塞主函数，使程序保持运行状态，直到显式退出。</p>
<p>   请根据你的实际需求，将代码中的注释部分替换为适当的 gRPC 服务注册和其他操作代码。</p>
</li>
<li><p>连接阻塞</p>
 <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 主要就是 grpc.WithBlock()</span></span><br><span class="line"></span><br><span class="line">conn2, err2 := grpc.Dial(*addr2, grpc.WithTransportCredentials(insecure.NewCredentials()),grpc.WithBlock())</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>循环变量副本</p>
<p>   for i :&#x3D; 1; i &lt;&#x3D; *rpc_num; i++ {</p>
<p>   if i &#x3D;&#x3D; *rpc_id {</p>
<p>   continue &#x2F;&#x2F; 跳过与 当前相同的 端口号 ，不能和自己连接</p>
<p>   }</p>
<p>   go func(){</p>
<p>   conn[i], err &#x3D; grpc.Dial(rpc_addr[i], grpc.WithTransportCredentials(insecure.NewCredentials()), grpc.WithBlock())</p>
<p>   if err !&#x3D; nil {</p>
<p>   log.Fatalf(“Failed to connect to server %s: %v”, rpc_addr[i], err)</p>
<p>   return</p>
<p>   }</p>
<p>   log.Printf(“Connect to %s OK”, rpc_addr[i])</p>
<p>   }()</p>
<p>   }</p>
<p>   这里有个提示信息但是没有报错，提示为：loop variable i captured by func litera</p>
<p>    “loop variable i captured by func literal” 意味着在你的代码中，匿名函数字面量（func literal）捕获了循环变量 i。</p>
<p>   在 Go 语言中，当你在循环体内使用匿名函数时，该匿名函数会形成一个闭包，它可以访问和引用外部作用域中的变量。在这种情况下，匿名函数引用了循环变量 i。然而，循环变量在每次迭代中的值会发生变化，这可能会导致一些意外的行为。</p>
<p>   为了避免这种问题，Go 语言引入了循环变量副本的概念。在每次迭代中，会为循环体内的匿名函数创建一个新的副本变量，以确保在闭包内部引用的是正确的值。这样可以避免循环变量值的竞争条件。</p>
<p>   解决这个问题的常见方法是在循环体内部创建一个局部变量，将循环变量的值复制给局部变量，然后在匿名函数中使用局部变量。例如：</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">for i := 1; i &lt;= *rpc_num; i++ &#123;</span><br><span class="line">    if i == *rpc_id &#123;</span><br><span class="line">        continue</span><br><span class="line">    &#125;</span><br><span class="line">    // 创建局部变量 iCopy 并将循环变量的值赋给它</span><br><span class="line">    iCopy := i</span><br><span class="line">    go func() &#123;</span><br><span class="line">        conn[iCopy], err = grpc.Dial(rpc_addr[iCopy], grpc.WithTransportCredentials(insecure.NewCredentials()), grpc.WithBlock())</span><br><span class="line">        if err != nil &#123;</span><br><span class="line">            log.Fatalf(&quot;Failed to connect to server %s: %v&quot;, rpc_addr[iCopy], err)</span><br><span class="line">            return</span><br><span class="line">        &#125;</span><br><span class="line">        log.Printf(&quot;Connect to %s OK&quot;, rpc_addr[iCopy])</span><br><span class="line">    &#125;()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>   通过创建局部变量 iCopy 并使用它，你可以确保每个匿名函数引用的是该迭代的正确值，而不会受到循环变量的更改影响。</p>
</li>
</ol>
<h1 id="Atomic-包"><a href="#Atomic-包" class="headerlink" title="Atomic 包"></a>Atomic 包</h1><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;log&quot;</span></span><br><span class="line">    <span class="string">&quot;net/http&quot;</span></span><br><span class="line">    <span class="string">&quot;runtime&quot;</span></span><br><span class="line">    <span class="string">&quot;sync/atomic&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> count <span class="type">int32</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">    currentCount := atomic.LoadInt32(&amp;count)</span><br><span class="line">    atomic.AddInt32(&amp;count, <span class="number">1</span>)</span><br><span class="line">    log.Println(<span class="string">&quot;count:&quot;</span>, currentCount)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    runtime.GOMAXPROCS(runtime.NumCPU() - <span class="number">1</span>)</span><br><span class="line">    http.HandleFunc(<span class="string">&quot;/&quot;</span>, test)</span><br><span class="line">    http.ListenAndServe(<span class="string">&quot;:8080&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Done-Wait-同步"><a href="#Done-Wait-同步" class="headerlink" title="Done Wait 同步"></a>Done Wait 同步</h1><p> Go 内存模型中的术语。它说明了在调用 <code>Done</code> 方法之前，它会与任何由它解除阻塞的 <code>Wait</code> 调用之后的返回之前进行”同步在”（synchronizes before）的关系。</p>
<p>具体解释如下：</p>
<ol>
<li><code>Done</code> 方法是用于通知等待组（WaitGroup）中某个操作的完成。</li>
<li><code>Wait</code> 方法是等待等待组中所有操作完成的调用。</li>
<li>“同步在”（synchronizes before）是 Go 内存模型中的同步关系，指示在同一个 goroutine 中，一个操作的执行在另一个操作之前进行了同步。</li>
</ol>
<p>根据这句话的解释，当一个 goroutine 调用 <code>Done</code> 方法时，它会在解除等待组中的某个操作的阻塞之前与该操作的返回之前进行同步。</p>
<p>具体来说，如果一个 goroutine 在调用 <code>Wait</code> 方法等待等待组中的操作时被阻塞，那么当另一个 goroutine 调用 <code>Done</code> 方法通知该操作的完成时，调用 <code>Done</code> 的 goroutine 会在被阻塞的 goroutine 返回之前进行同步。这确保了在 <code>Done</code> 方法解除阻塞之后，等待的 goroutine 可以安全地继续执行。</p>
<p>总之，这句话的含义是在 Go 内存模型中，<code>Done</code> 方法的调用会在解除阻塞的 <code>Wait</code> 调用的返回之前进行同步。这个同步关系确保了等待组的协同操作的正确性和可靠性。</p>

                        
                    </div>
                </div>
            </div>
            
                <footer class="kratos-post-meta-new">
                    <span class="pull-left">
                        <time datetime="2024-04-22T13:14:48.678Z" itemprop="datePublished">
                            <a><i class="fa fa-calendar"></i> 2024-04-22</a>
                        </time>
                        
                        
                            <!-- 当前仅支持valine/waline自带的统计功能 -->
                            
                        
                        
                            <!-- 当前仅支持waline自带的统计功能 -->
                            
                        
                    </span>
                    
                    
                        <span class="pull-right">
                            <a class="read-more" href="/2024/04/22/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/GO_lang/go%20%E9%AB%98%E7%BA%A7/" title="留言">留言<i class="fa fa-chevron-circle-right"></i></a>
                        </span>
                    

                </footer>
            
        </article>
    

    
    
        <article class="kratos-hentry kratos-entry-border-new clearfix" itemscope itemtype="https://schema.org/Article">
            <div class="kratos-status">
                
                    <i class="fa fa-refresh"></i>
                
                <div class="kratos-status-inner">
                    <div class="kratos-status-content" itemprop="articleBody">
                        
                            <p>go个人笔记</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weiguang102/article/details/128501539">https://blog.csdn.net/weiguang102/article/details/128501539</a></p>
<p>go 基础</p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/go/go-tutorial.html">https://www.runoob.com/go/go-tutorial.html</a></p>
<p>go 环境安装</p>
<p><a target="_blank" rel="noopener" href="https://blog.51cto.com/fish/5734211">https://blog.51cto.com/fish/5734211</a></p>
<h2 id="零、配置"><a href="#零、配置" class="headerlink" title="零、配置"></a>零、配置</h2><h3 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h3><p>1.临时添加环境变量 PATH</p>
<p>export PATH&#x3D;$PATH:&#x2F;usr&#x2F;local&#x2F;go&#x2F;bin</p>
<p>2.所有用户永久添加环境变量</p>
<p>vim &#x2F;etc&#x2F;profile</p>
<p>末尾添加：export PATH:$PATH:&#x2F;usr&#x2F;local&#x2F;go&#x2F;bin</p>
<p>刷新：sourse &#x2F;etc&#x2F;profile</p>
<p>3.golang 工作目录</p>
<p>GOPATH 是一个环境变量，用于指定Go项目的工作目录，默认情况下，GOPATH是 $HOME是当前用户的主目录。(&#x2F;root 或者 &#x2F;home&#x2F;user1)</p>
<p>获取：</p>
<p>go env GOPATH</p>
<p>更改：</p>
<p>编辑 .bashrc 或者 .zshrc</p>
<p>找到 GOPATH 这行，将其修改为 &#x2F;path&#x2F;to&#x2F;your&#x2F;gopath</p>
<p>4.go.sum 与 go.mod</p>
<p><code>go.sum</code> 和 <code>go.mod</code> 是 Go 语言中用于管理模块依赖的文件。</p>
<ul>
<li><p><code>go.mod</code> 文件：<code>go.mod</code> 文件用于定义和管理项目的模块依赖关系。它位于项目的根目录下。当你使用 <code>go get</code> 命令来安装或更新依赖包时，<code>go.mod</code> 文件会被更新。它记录了项目所依赖的模块及其版本。你可以手动编辑 <code>go.mod</code> 文件来添加、移除或升级依赖包。在构建项目时，Go 会根据 <code>go.mod</code> 文件获取所需的依赖包。</p>
</li>
<li><p><code>go.sum</code> 文件：<code>go.sum</code> 文件用于记录项目所使用模块的校验和信息。每个模块都有一个唯一的校验和，用于确保下载的模块的完整性和安全性。<code>go.sum</code> 文件会自动生成并更新，其中包含了所有依赖模块的校验和。当你构建项目时，Go 会根据 <code>go.sum</code> 文件验证模块的完整性，以确保下载的模块与之前的校验和匹配。</p>
</li>
</ul>
<p>使用 <code>go.mod</code> 和 <code>go.sum</code> 文件的基本操作如下：</p>
<ol>
<li><p>初始化模块：在项目的根目录下执行 <code>go mod init</code> 命令，它会根据项目的路径和名称创建一个新的 <code>go.mod</code> 文件。</p>
</li>
<li><p>添加依赖包：执行 <code>go get</code> 命令来添加所需的依赖包。例如，<code>go get</code> <code>github.com/example/package</code>。这会自动更新 <code>go.mod</code> 文件并下载依赖包。</p>
</li>
<li><p>移除依赖包：执行 <code>go mod tidy</code> 命令来移除不再使用的依赖包。它会自动更新 <code>go.mod</code> 文件并删除不需要的依赖。</p>
</li>
<li><p>升级依赖包：执行 <code>go get -u</code> 命令来升级依赖包到最新版本。这会自动更新 <code>go.mod</code> 文件。</p>
</li>
<li><p>构建项目：使用 <code>go build</code> 或 <code>go run</code> 命令来构建或运行项目。Go 会根据 <code>go.mod</code> 文件下载依赖包并构建项目。</p>
</li>
</ol>
<p>需要注意的是，<code>go.mod</code> 和 <code>go.sum</code> 文件对于保证项目的可复现性和依赖包的一致性非常重要。当你与他人共享项目时，确保将 <code>go.mod</code> 和 <code>go.sum</code> 文件一同共享，以便其他人可以获取相同的依赖包版本。</p>
<p>管理和安装 <code>go.mod</code> 和 <code>go.sum</code> 中列出的依赖项：</p>
<ol>
<li><strong>下载依赖项</strong></li>
</ol>
<p>当你首次克隆一个 Go 项目或者在已有项目中更新了依赖项时，可以使用以下命令来下载 <code>go.mod</code> 文件中指定的所有依赖项：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go mod download</span><br></pre></td></tr></table></figure>

<p>这个命令会将依赖项下载到本地的 Go 模块缓存中，但不会在项目目录中创建任何文件。</p>
<ol start="2">
<li><strong>同步依赖项</strong></li>
</ol>
<p>如果你想确保项目目录下的依赖项与 <code>go.mod</code> 文件中定义的依赖项完全同步（即添加缺失的模块，删除不需要的模块，并更新 <code>go.sum</code>），可以使用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go mod tidy</span><br></pre></td></tr></table></figure>

<p><code>go mod tidy</code> 命令会添加缺少的模块，移除未使用的模块，并生成一个新的 <code>go.sum</code> 文件。这是确保 <code>go.mod</code> 和 <code>go.sum</code> 文件准确反映项目依赖项的好方法。</p>
<ol start="3">
<li><strong>查看依赖项</strong></li>
</ol>
<p>如果你想查看当前项目的依赖树，可以使用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go mod graph</span><br></pre></td></tr></table></figure>

<p>这个命令会打印项目的所有依赖项及其版本，帮助你理解项目依赖的结构。</p>
<ol start="4">
<li><strong>更新依赖项</strong></li>
</ol>
<p>要更新项目中的某个依赖项到最新版本，可以使用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go get -u package@version</span><br></pre></td></tr></table></figure>

<p>其中 <code>package</code> 是依赖项的路径，<code>version</code> 是你想要更新到的版本。如果你想更新所有依赖项到最新版本，可以使用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go get -u</span><br></pre></td></tr></table></figure>

<p>但请注意，这可能会引入重大更改，因此建议仔细测试更新后的依赖项。</p>
<p>修改 proto 文件并运行 <code>make proto</code> 来更新 <code>proto/pkg/xxx/xxx.pb.go</code> 中相关生成的 go 代码</p>
<h2 id="一、变量"><a href="#一、变量" class="headerlink" title="一、变量"></a>一、变量</h2><h3 id="一般变量"><a href="#一般变量" class="headerlink" title="一般变量"></a>一般变量</h3><ol>
<li><p>变量声明</p>
<ol>
<li>标准格式</li>
</ol>
 <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var name type <span class="comment">// 注意：声明变量时将变量的类型放在变量的名称之后</span></span><br><span class="line">var a,b *<span class="type">int</span> <span class="comment">// 将 a b 同时声明为指针类型</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化</span></span><br><span class="line">var hp <span class="type">int</span> = <span class="number">100</span> <span class="comment">// 指定类型</span></span><br><span class="line">var hp = <span class="number">100</span> <span class="comment">// 省略类型，编译器会尝试为变量推到类型</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>简短格式</li>
</ol>
</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 名字 := 表达式</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1. 定义变量，同时显式初始化。</span></span><br><span class="line"><span class="comment">2. 不能提供数据类型</span></span><br><span class="line"><span class="comment">3. 只能用在函数内部。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 同时声明+初始化</span></span><br><span class="line">i, j := <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">func <span class="built_in">main</span>() &#123;</span><br><span class="line">   x:=<span class="number">100</span></span><br><span class="line">   a,s:=<span class="number">1</span>, <span class="string">&quot;abc&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 注意  :=  左面必须是新变量</span></span><br><span class="line">var hp <span class="type">int</span> <span class="comment">// 声明 hp 变量</span></span><br><span class="line">hp := <span class="number">10</span>  <span class="comment">// 再次声明并赋值  报错！ 左面没有新变量出现</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误！！！！其实 只要有新变量就行！</span></span><br><span class="line">var conn net.Conn</span><br><span class="line">var err error</span><br><span class="line">conn, err = net.<span class="built_in">Dial</span>(<span class="string">&quot;tcp&quot;</span>, <span class="string">&quot;127.0.0.1:8080&quot;</span>)  <span class="comment">// 不会报错</span></span><br></pre></td></tr></table></figure>

<p>注意：变量的命名规则遵循骆驼命名法，即首个单词小写，每个新单词的首字母大写，例如：numShips 和 startDate 。</p>
<ol start="2">
<li><p>变量类型</p>
<ol>
<li><p>bool</p>
</li>
<li><p>string</p>
<ol>
<li><p>反引号可以实现多行</p>
 <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> str = `第一行</span><br><span class="line">第二行</span><br><span class="line">第三行</span><br><span class="line">` </span><br><span class="line">fmt.<span class="built_in">Println</span>(str);  <span class="comment">// 输出上面的内容</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意 ！！！！！！</span></span><br><span class="line"><span class="comment">// 此时所有的 转义都会失效，即 `` 内部的全部都视为 字符串一部分</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>字符串长度</p>
<ol>
<li><p>len(), 判断的是 ASCII 长度 或者是 字节长度</p>
<ol>
<li><p>在 go 语言中， 所有字符串都是以 utf-8 的格式保存，因此 汉字 3 字节，字符 1 字节</p>
</li>
<li><p>若要将汉字作为一个整体统计， 可以使用下面的函数</p>
</li>
</ol>
</li>
<li><p>RuneCountInString() , 判断的是字符的个数，或者说是 Unicode 字符串长度</p>
 <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">package main</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">import</span> <span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="string">&quot;fmt&quot;</span></span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="string">&quot;strings&quot;</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// 遍历字符串</span></span></span><br><span class="line"><span class="function"><span class="comment">// 按ASCII 字符</span></span></span><br><span class="line"><span class="function">theme :=</span> <span class="string">&quot;狙击 start&quot;</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(theme); i++ &#123;<span class="comment">//使用 for 的数值循环进行遍历--</span></span><br><span class="line">    fmt.<span class="built_in">Printf</span>(<span class="string">&quot;ascii: %c  %d\n&quot;</span>, theme[i], theme[i])</span><br><span class="line">&#125;<span class="comment">// 这里 汉字为乱码</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 按 Unicode  字符</span></span><br><span class="line">theme := <span class="string">&quot;狙击 start&quot;</span></span><br><span class="line"><span class="keyword">for</span> _, s := range theme &#123;</span><br><span class="line">    fmt.<span class="built_in">Printf</span>(<span class="string">&quot;Unicode: %c  %d\n&quot;</span>, s, s)</span><br><span class="line">&#125;<span class="comment">// 这里汉字正常显示</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串截取</span></span><br><span class="line">newtr := theme[i:]  <span class="comment">// 截取部分包括 i</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串搜索</span></span><br><span class="line">strings.<span class="built_in">Index</span>(strings ,substring); <span class="comment">// 返回 下标</span></span><br><span class="line">strings.<span class="built_in">LastIndex</span>(strings, substrings); <span class="comment">// 反向搜索</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串修改</span></span><br><span class="line">        s1 := <span class="string">&quot;abc&quot;</span></span><br><span class="line"><span class="comment">//     注意：字符串无法修改，只能在复制的基础上进行修改</span></span><br><span class="line"><span class="comment">//  方法一  转为 []byte()</span></span><br><span class="line">        s2 := []<span class="built_in">byte</span>(s1)</span><br><span class="line">        s2[<span class="number">1</span>] = <span class="string">&#x27;B&#x27;</span></span><br><span class="line">        fmt.<span class="built_in">Println</span>(<span class="built_in">string</span>(s2)) <span class="comment">//aBc</span></span><br><span class="line"><span class="comment">// 方法二  转为 []runej() </span></span><br><span class="line">        s3 := []<span class="built_in">rune</span>(s1)</span><br><span class="line">        s3[<span class="number">1</span>] = <span class="string">&#x27;B&#x27;</span></span><br><span class="line">        fmt.<span class="built_in">Println</span>(<span class="built_in">string</span>(s3)) <span class="comment">//aBc</span></span><br><span class="line"> <span class="comment">// 方法三 字符串替换</span></span><br><span class="line">        new_str := <span class="string">&quot;ABC&quot;</span></span><br><span class="line">        old_str := <span class="string">&quot;abc&quot;</span></span><br><span class="line">        s4 := strings.<span class="built_in">Replace</span>(s1, old_str , new_str , <span class="number">2</span>)</span><br><span class="line">        fmt.<span class="built_in">Println</span>(s4) <span class="comment">//ABC</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串拼接</span></span><br><span class="line">    str1 := <span class="string">&quot;hello&quot;</span></span><br><span class="line">    str2 := <span class="string">&quot;world&quot;</span></span><br><span class="line"> <span class="comment">// 方法一 使用 + 直接拼接</span></span><br><span class="line">     str3 := str1 + str2</span><br><span class="line"> <span class="comment">// 方法二 使用 bytes.Buffer</span></span><br><span class="line">     var stringBuilder bytes.Buffer</span><br><span class="line">     stringBuilder.<span class="built_in">WriteString</span>(str1)</span><br><span class="line">     stringBuilder.<span class="built_in">WriteString</span>(str2)</span><br><span class="line">     str4 := stringBuilder.<span class="built_in">String</span>()</span><br><span class="line">     </span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
</li>
<li><p>int、int8、int16、int32、int64</p>
</li>
<li><p>uint、uint8、uint16、uint32、uint64、uintptr</p>
</li>
<li><p>byte &#x2F;&#x2F; uint8 的别名</p>
</li>
<li><p>rune &#x2F;&#x2F; int32 的别名 代表一个 Unicode 码 不对 是 UTF-8</p>
</li>
<li><p>float32、float64</p>
</li>
<li><p>complex64、complex128 内建函数</p>
</li>
<li><p>interface 接口类型<br> <a target="_blank" rel="noopener" href="https://learnku.com/go/t/38843">https://learnku.com/go/t/38843</a></p>
 <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Animal <span class="keyword">interface</span> &#123;</span><br><span class="line">    Speak() <span class="type">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>map[string] *sync.WaitGroup  键值对类型</p>
</li>
</ol>
</li>
<li><p>变量赋值</p>
 <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b, a = a, b  <span class="comment">// 这里 可以实现交换操作</span></span><br><span class="line">a, _ := a, _ := <span class="built_in">GetData</span>()  <span class="comment">// 这里 匿名变量</span></span><br></pre></td></tr></table></figure>
<p>   注意：<strong>当一个变量被声明之后，系统自动赋予它该类型的零值：</strong><strong><code>int 为 0，float 为 0.0，bool 为 false，string 为空字符串，指针为 nil 等</code></strong></p>
<p>   所有的内存在 Go 中都是经过初始化的。</p>
</li>
<li><p>匿名变量不占用内存空间，不分配内存</p>
</li>
<li><p>作用域</p>
<ol>
<li>全局变量声明必须以 <code>var</code> 关键字开头，如果想要在外部包中使用全局变量的首字母必须大写。</li>
<li>特殊变量定义位置 <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> firstIdx, err := Func(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">	        log.Fatal(err)</span><br><span class="line">	        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	    &#125;</span><br><span class="line">	    <span class="comment">// 这里的 firstIdx 只能在 if 里面的大括号用，一旦出去就使用不了</span></span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>比较</p>
<p>   只有同类型的变量才能进行比较</p>
<p>   包括 0 1 到 true false 的转换</p>
</li>
<li><p>类型转换</p>
<ol>
<li><p>bool 不能强转为 int</p>
 <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var n <span class="type">bool</span></span><br><span class="line">n := (<span class="type">int</span>)n</span><br><span class="line"><span class="comment">//会报错</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>不能获取数组某个位置的的地址</p>
</li>
</ol>
</li>
</ol>
<h3 id="结构体变量"><a href="#结构体变量" class="headerlink" title="结构体变量"></a>结构体变量</h3><ol>
<li>结构体声明 <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 结构体成员变量</span></span><br><span class="line"><span class="keyword">type</span> MyStruct <span class="keyword">struct</span>&#123;</span><br><span class="line">	age <span class="type">int</span>     <span class="comment">// 注意没有 逗号</span></span><br><span class="line">	name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 结构体函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ms *MyStruct)</span></span> grow(<span class="type">int</span> a) <span class="type">bool</span>&#123;</span><br><span class="line">	ms.age += a</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结构体的指针继承</span></span><br><span class="line"><span class="keyword">type</span> MyStruct2 <span class="keyword">struct</span>&#123;</span><br><span class="line">	*MyStruct  <span class="comment">// 通过指针的方式，父亲结构体作为一个无名成员变量，</span></span><br><span class="line">			   <span class="comment">// 赋值时使用 父亲对象 赋值； </span></span><br><span class="line">			   <span class="comment">// 使用时使用 孩子对象 直接使用（不需要先点出来父亲）</span></span><br><span class="line">	age <span class="type">int</span>     <span class="comment">// 注意没有 逗号</span></span><br><span class="line">	name <span class="type">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>结构体实例化 <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法一：var 声明</span></span><br><span class="line"><span class="keyword">var</span> fan MyStruct   <span class="comment">// 为 fan 分配内存并且零化值</span></span><br><span class="line">fan.age = <span class="number">26</span></span><br><span class="line">fan.name = <span class="string">&quot;fan&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法二：new 关键字</span></span><br><span class="line"><span class="comment">// 11</span></span><br><span class="line">fan := &amp;MyStruct&#123;   <span class="comment">// 返回一个结构体指针，带有初始值</span></span><br><span class="line">	<span class="number">26</span>,</span><br><span class="line">	<span class="string">&quot;fan&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 22 </span></span><br><span class="line">fan := <span class="built_in">new</span>(MyStruct) <span class="comment">// 返回一个结构体指针，零值</span></span><br><span class="line">fan.name = <span class="string">&quot;fan&quot;</span></span><br><span class="line">fan.age = <span class="number">26</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法三：赋值初始化</span></span><br><span class="line"><span class="comment">// 11</span></span><br><span class="line">fan := MyStruct&#123;</span><br><span class="line">	name: <span class="string">&quot;fan&quot;</span>,</span><br><span class="line">	age: <span class="number">26</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 22：必须要对应结构体定义顺序，并且每一个都必须进行初始化。</span></span><br><span class="line">fan := MyStruct&#123;</span><br><span class="line">	<span class="number">26</span>,</span><br><span class="line">	<span class="string">&quot;fan&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>匿名结构体 <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">profile := &amp;<span class="keyword">struct</span> &#123;</span><br><span class="line">           name <span class="type">string</span></span><br><span class="line">           age   <span class="type">int</span></span><br><span class="line">   &#125;&#123;</span><br><span class="line">           name: <span class="string">&quot;rat&quot;</span>,</span><br><span class="line">           age:   <span class="number">150</span>,</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// 打印值</span></span><br><span class="line">   fmt.Printf(<span class="string">&quot;使用&#x27;%%+v&#x27; %+v\n&quot;</span>, profile)</span><br><span class="line">   fmt.Printf(<span class="string">&quot;使用&#x27;%%#v&#x27; %#v\n&quot;</span>, profile)</span><br><span class="line">   fmt.Printf(<span class="string">&quot;使用&#x27;%%T&#x27; %T\n&quot;</span>, profile)</span><br></pre></td></tr></table></figure></li>
<li>结构体返回值 <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newStruct</span><span class="params">()</span></span> * MyStruct&#123;</span><br><span class="line">	<span class="comment">// 此处替换为三种不同方式</span></span><br><span class="line">    <span class="keyword">var</span> fan MyStruct   <span class="comment">// 为 fan 分配内存并且零化值</span></span><br><span class="line">	fan.age = <span class="number">26</span></span><br><span class="line">	fan.name = <span class="string">&quot;fan&quot;</span></span><br><span class="line">	fmt.Printf(<span class="string">&quot;函数内变量 fan 的地址为：%p\n&quot;</span>, &amp;fan)</span><br><span class="line">	<span class="keyword">return</span> &amp;fan</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fan := newStruct()</span><br><span class="line">    fmt.Printf(<span class="string">&quot;函数外变量 fan 的地址为：%p\n&quot;</span>, fan)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;fan使用&#x27;%%+v&#x27; %+v\n&quot;</span>, fan)</span><br><span class="line">	fan.age = <span class="number">18</span></span><br><span class="line">	fmt.Printf(<span class="string">&quot;fan使用&#x27;%%+v&#x27; %+v\n&quot;</span>, fan)</span><br><span class="line">	<span class="comment">// 方法一：地址相同，可更改 </span></span><br><span class="line">	<span class="comment">// 方法二11：地址相同，可更改</span></span><br><span class="line">	<span class="comment">// 方法二22：地址相同，可更改</span></span><br><span class="line">	<span class="comment">// 方法三11：地址相同，可更改</span></span><br><span class="line">	<span class="comment">// 方法三22：地址相同，可更改</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="键值对类型"><a href="#键值对类型" class="headerlink" title="键值对类型"></a>键值对类型</h3><p>map[string] *sync.WaitGroup  键值对类型</p>
<ol>
<li>键值对变量<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">        <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MyStruct <span class="keyword">struct</span> &#123;</span><br><span class="line">    a, b <span class="type">uint64</span></span><br><span class="line">&#125;</span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// !! 定义与使用 </span></span><br><span class="line">    <span class="comment">//  初始 正常运行</span></span><br><span class="line">    stru := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">uint64</span>]*MyStruct)</span><br><span class="line">    stru[<span class="number">2</span>] = &amp;MyStruct&#123;</span><br><span class="line">        <span class="number">1</span>,<span class="number">1</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    stru[<span class="number">2</span>].a = <span class="number">1</span></span><br><span class="line">    stru[<span class="number">2</span>].b  = <span class="number">1</span></span><br><span class="line">    fmt.Printf(<span class="string">&quot;值为：%+v&quot;</span>,stru[<span class="number">2</span>])</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//  这样也可以</span></span><br><span class="line">    <span class="keyword">var</span> stru <span class="keyword">map</span>[<span class="type">uint64</span>]*MyStruct </span><br><span class="line">    stru = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">uint64</span>]*MyStruct) <span class="comment">// 没有这行运行不通</span></span><br><span class="line">    stru[<span class="number">2</span>] = &amp;MyStruct&#123;   <span class="comment">// 去掉这行也不行</span></span><br><span class="line">        <span class="number">1</span>,<span class="number">1</span>,</span><br><span class="line">    &#125;  </span><br><span class="line">    stru[<span class="number">2</span>].a = <span class="number">1</span></span><br><span class="line">    stru[<span class="number">2</span>].b  = <span class="number">1</span></span><br><span class="line">    fmt.Printf(<span class="string">&quot;值为：%+v&quot;</span>,stru[<span class="number">2</span>])</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 结论： map 必须通过 make 且 键值对必须 初始化。才能修改</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 判断键值是否存在</span></span><br><span class="line">	<span class="keyword">if</span> _, ok := stru[<span class="number">2</span>]; !ok &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line">	</span><br></pre></td></tr></table></figure></li>
<li>键值对作为结构体成员变量<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">        <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MyStruct <span class="keyword">struct</span> &#123;</span><br><span class="line">    a, b <span class="type">uint64</span></span><br><span class="line">&#125;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">type</span> MS <span class="keyword">struct</span>&#123;</span><br><span class="line">    stu  <span class="keyword">map</span>[<span class="type">uint64</span>]*MyStruct</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> stru MS</span><br><span class="line">    stru.stu = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">uint64</span>]*MyStruct) <span class="comment">// 1 </span></span><br><span class="line">       stru.stu[<span class="number">2</span>]  = &amp; MyStruct&#123; <span class="comment">// 2 , 1 2 这两步都是必须的，且可以多次执行不会冲突</span></span><br><span class="line">           <span class="number">1</span>,<span class="number">1</span>,</span><br><span class="line">       &#125;</span><br><span class="line">    stru.stu[<span class="number">2</span>].a =<span class="number">1</span></span><br><span class="line">    stru.stu[<span class="number">2</span>].b =<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    fmt.Printf(<span class="string">&quot;值为：%+v&quot;</span>,stru.stu[<span class="number">2</span>])</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><ol>
<li>定义  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构造特定大小的数组，初始会有 size 的大小，每一个元素会有一个初始值，默认0</span></span><br><span class="line">ids := <span class="built_in">make</span>([]<span class="type">uint64</span>, size)</span><br><span class="line"><span class="comment">// 构造大小为 0 的数组</span></span><br><span class="line"><span class="keyword">var</span>   ids  []<span class="type">uint64</span></span><br><span class="line"><span class="comment">//! 注意两种 定义方式 都可以用下面的方法增加元素 </span></span><br><span class="line"><span class="comment">// 增加元素</span></span><br><span class="line">ids = <span class="built_in">append</span>(ids,<span class="number">1</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="二、输入、输出"><a href="#二、输入、输出" class="headerlink" title="二、输入、输出"></a>二、输入、输出</h2><ol>
<li><p>fmt.Sprintf(格式化样式 ， 参数列表)</p>
<ol>
<li>和 C 语言类似 printf</li>
</ol>
</li>
<li><p>fmt.Println(str)</p>
</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">package main</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">import</span> <span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="string">&quot;fmt&quot;</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">func <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        var progress = <span class="number">2</span></span><br><span class="line">        var target = <span class="number">8</span></span><br><span class="line">        <span class="comment">// 两参数格式化</span></span><br><span class="line">        title := fmt.<span class="built_in">Sprintf</span>(<span class="string">&quot;已采集%d个药草, 还需要%d个完成任务&quot;</span>, progress, target)</span><br><span class="line">        fmt.<span class="built_in">Println</span>(title)</span><br><span class="line">        pi := <span class="number">3.14159</span></span><br><span class="line">        <span class="comment">// 按数值本身的格式输出</span></span><br><span class="line">        variant := fmt.<span class="built_in">Sprintf</span>(<span class="string">&quot;%v %v %v&quot;</span>, <span class="string">&quot;月球基地&quot;</span>, pi, <span class="literal">true</span>) <span class="comment">//月球基地 3.14159 true</span></span><br><span class="line">        fmt.<span class="built_in">Println</span>(variant)</span><br><span class="line">        <span class="comment">// 匿名结构体声明, 并赋予初值</span></span><br><span class="line">        profile := &amp;<span class="keyword">struct</span> &#123;</span><br><span class="line">                Name string</span><br><span class="line">                HP   <span class="type">int</span></span><br><span class="line">        &#125;&#123;</span><br><span class="line">                Name: <span class="string">&quot;rat&quot;</span>,</span><br><span class="line">                HP:   <span class="number">150</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 双百分号表示转义</span></span><br><span class="line">        fmt.<span class="built_in">Printf</span>(<span class="string">&quot;使用&#x27;%%+v&#x27; %+v\n&quot;</span>, profile)  <span class="comment">// 使用&#x27;%+v&#x27; &amp;&#123;Name:rat HP:150&#125;</span></span><br><span class="line">        fmt.<span class="built_in">Printf</span>(<span class="string">&quot;使用&#x27;%%#v&#x27; %#v\n&quot;</span>, profile)  <span class="comment">// 使用&#x27;%#v&#x27; &amp;struct &#123; Name string; HP int &#125;&#123;Name:&quot;rat&quot;, HP:150&#125;</span></span><br><span class="line">        fmt.<span class="built_in">Printf</span>(<span class="string">&quot;使用&#x27;%%T&#x27; %T\n&quot;</span>, profile)  <span class="comment">// 使用&#x27;%T&#x27; *struct &#123; Name string; HP int &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>动 词 功 能</p>
<p>   %v 按值的本来值输出</p>
<p>   %+v 在 %v 基础上，对结构体字段名和值进行展开</p>
<p>   %#v 输出 Go 语言语法格式的值</p>
<p>   %T 输出 Go 语言语法格式的类型和值</p>
<p>   %% 输出 % 本体</p>
<p>   %b 整型以二进制方式显示</p>
<p>   %o 整型以八进制方式显示</p>
<p>   %d 整型以十进制方式显示</p>
<p>   %x 整型以十六进制方式显示</p>
<p>   %X 整型以十六进制、字母大写方式显示</p>
<p>   %U Unicode 字符</p>
<p>   %f 浮点数</p>
<p>   %p 指针，十六进制方式显示</p>
</li>
</ol>
<h2 id="四、-库"><a href="#四、-库" class="headerlink" title="四、 库"></a>四、 库</h2><h4 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h4><p>功能：Go 语言标准库中的一个包，用于解析命令行参数</p>
<p>关键函数：</p>
<p>flag.type(arg_name,arg_default_value,arg_discription) -&gt; value</p>
<p>flag.Parse() ：解析命令获得各个参数的值</p>
<p>实例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">func <span class="function"><span class="title">main</span></span>() &#123;</span><br><span class="line">        // 定义命令行参数</span><br><span class="line">        num1 := flag.Int(<span class="string">&quot;num1&quot;</span>, 0, <span class="string">&quot;第一个整数&quot;</span>)</span><br><span class="line">        num2 := flag.Int(<span class="string">&quot;num2&quot;</span>, 0, <span class="string">&quot;第二个整数&quot;</span>)</span><br><span class="line"></span><br><span class="line">        // 解析命令行参数</span><br><span class="line">        flag.Parse()</span><br><span class="line">        </span><br><span class="line">        // 计算和</span><br><span class="line">        <span class="built_in">sum</span> := *num1 + *num2</span><br><span class="line"></span><br><span class="line">        // 输出结果</span><br><span class="line">        fmt.Println(<span class="string">&quot;和:&quot;</span>, <span class="built_in">sum</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="三、常见技巧"><a href="#三、常见技巧" class="headerlink" title="三、常见技巧"></a>三、常见技巧</h2><h3 id="常见调用"><a href="#常见调用" class="headerlink" title="常见调用"></a>常见调用</h3><ol>
<li>获取变量类型<br> varb.(type)</li>
<li>获取数组长度<br> len(arr)</li>
</ol>
<h3 id="键值对KV"><a href="#键值对KV" class="headerlink" title="键值对KV"></a>键值对KV</h3><p>go语言中可以使用<code>map[string]interface&#123;&#125;</code>类型来实现，键的索引和值的多种类型</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line">import (</span><br><span class="line">        <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func <span class="function"><span class="title">main</span></span>() &#123;</span><br><span class="line">        // 定义</span><br><span class="line">        data := map[string]interface&#123;&#125;&#123;</span><br><span class="line">                <span class="string">&quot;myname&quot;</span>: <span class="string">&quot;电子科技大学@2023&quot;</span>,</span><br><span class="line">                <span class="string">&quot;tasks&quot;</span>:  []string&#123;<span class="string">&quot;task 1&quot;</span>, <span class="string">&quot;task 2&quot;</span>, <span class="string">&quot;task 3&quot;</span>&#125;,</span><br><span class="line">                <span class="string">&quot;age&quot;</span>:    25,</span><br><span class="line">                <span class="string">&quot;isStudent&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        // 增加</span><br><span class="line">        data[<span class="string">&quot;newKey&quot;</span>] = <span class="string">&quot;New Value&quot;</span></span><br><span class="line">        </span><br><span class="line">        // 删除</span><br><span class="line">        delete(data, <span class="string">&quot;age&quot;</span>) // 删除 data 中键为 “age” 的键值对</span><br><span class="line">        // 查找</span><br><span class="line">        key := <span class="string">&quot;tasks&quot;</span></span><br><span class="line">        value, found := data[key]</span><br><span class="line">        <span class="keyword">if</span> found &#123;</span><br><span class="line">                fmt.Printf(<span class="string">&quot;Value of key &#x27;%s&#x27;: %v\n&quot;</span>, key, value)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                fmt.Printf(<span class="string">&quot;Key &#x27;%s&#x27; not found\n&quot;</span>, key)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        // json 解析为键值对 KV 形式</span><br><span class="line">        str := `&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;@2023&quot;</span>&#125;`</span><br><span class="line">        var data map[string]interface&#123;&#125;</span><br><span class="line">        errr := json.Unmarshal([]byte(str), &amp;data)</span><br><span class="line">        <span class="keyword">if</span> errr != nil &#123;</span><br><span class="line">            // 处理解析错误</span><br><span class="line">        &#125;</span><br><span class="line">        fmt.Println(data[<span class="string">&quot;name&quot;</span>])</span><br><span class="line">        </span><br><span class="line">        // 多个键值对支持</span><br><span class="line">            // 局部</span><br><span class="line">            data := make(map[string]interface&#123;&#125;)</span><br><span class="line">            // 全局</span><br><span class="line">            var data map[string]interface&#123;&#125; = make(map[string]interface&#123;&#125;)</span><br><span class="line">            </span><br><span class="line">        // 获取键值对的 K V</span><br><span class="line">        <span class="keyword">for</span> k, v := range data &#123;</span><br><span class="line">             existingData[k] = v</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        // 将 KV对 处理为 json格式</span><br><span class="line">        jsonData, err := json.Marshal(data)</span><br><span class="line">        <span class="keyword">if</span> err != nil &#123;</span><br><span class="line">                // 处理编码错误</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        // 将 K V 处理为 json格式</span><br><span class="line">            // 方法 一：</span><br><span class="line">            // fmt.Fprintf(w, <span class="string">&quot;&#123;&#x27;%s&#x27;:&#x27;%v&#x27;&#125;&quot;</span>, param, value)</span><br><span class="line">            </span><br><span class="line">            // 方法 二：</span><br><span class="line">            jsonData, err := json.Marshal(map[string]interface&#123;&#125;&#123;</span><br><span class="line">                param: value,</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">if</span> err != nil &#123;</span><br><span class="line">                // 处理编码错误</span><br><span class="line">            &#125;</span><br><span class="line">       </span><br><span class="line">        </span><br><span class="line">        //</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="数据排序"><a href="#数据排序" class="headerlink" title="数据排序"></a>数据排序</h3><p>对数据集合（包括自定义数据类型的集合）排序需要实现 sort.Interface 接口的三个方法，以下为该接口的定义：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Interface <span class="keyword">interface</span> &#123;</span><br><span class="line">        <span class="comment">// 获取数据集合元素个数</span></span><br><span class="line">        Len() <span class="type">int</span></span><br><span class="line">        <span class="comment">// 如果 i 索引的数据小于 j 索引的数据，返回 true 且不会调用下面的 Swap()，即数据升序排序。</span></span><br><span class="line">        Less(i, j <span class="type">int</span>) <span class="type">bool</span></span><br><span class="line">        <span class="comment">// 交换 i 和 j 索引的两个元素的位置</span></span><br><span class="line">        Swap(i, j <span class="type">int</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>数据集合实现了这三个方法后，即可调用该包的 Sort() 方法进行排序。 Sort() 方法定义如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Sort</span><span class="params">(data Interface)</span></span></span><br></pre></td></tr></table></figure>

<p>例子：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义</span></span><br><span class="line"><span class="keyword">type</span> messageSlice []pb.Message</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s messageSlice)</span></span> Len() <span class="type">int</span>           &#123; <span class="keyword">return</span> <span class="built_in">len</span>(s) &#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s messageSlice)</span></span> Less(i, j <span class="type">int</span>) <span class="type">bool</span> &#123; <span class="keyword">return</span> fmt.Sprint(s[i]) &lt; fmt.Sprint(s[j]) &#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s messageSlice)</span></span> Swap(i, j <span class="type">int</span>)      &#123; s[i], s[j] = s[j], s[i] &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line">sort.Sort(messageSlice(msgs)) <span class="comment">// msgs 为 []pb.Message 类型， 先强转再使用</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="数据比较"><a href="#数据比较" class="headerlink" title="数据比较"></a>数据比较</h3><p>reflect包中的DeepEqual函数完美的解决了比较问题。</p>
<p>函数签名：</p>
<p>func DeepEqual(a1, a2 interface{}) bool</p>
<p>文档中对该函数的说明：<br>DeepEqual函数用来判断两个值是否深度一致：除了类型相同；在可以时（主要是基本类型）会使用&#x3D;&#x3D;；但还会比较array、slice的成员，map的键值对，结构体字段进行深入比对。map的键值对，对键只使用&#x3D;&#x3D;，但值会继续往深层比对。DeepEqual 函数可以正确处理循环的类型。函数类型只有都会nil时才相等；空切片不等于nil切片；还会考虑array、slice的长度、map键值对数。<br>示例：</p>
<p>func main() {<br>    m1 :&#x3D; map[int]interface{}{1: []int{1, 2, 3}, 2: 3, 3: “a”}<br>    m2 :&#x3D; map[int]interface{}{1: []int{1, 2, 3}, 2: 3, 3: “a”}<br>    if reflect.DeepEqual(m1, m2) {<br>        fmt.Println(“相等”)<br>    }<br>}</p>
<p>uestc.leemen.org</p>

                        
                    </div>
                </div>
            </div>
            
                <footer class="kratos-post-meta-new">
                    <span class="pull-left">
                        <time datetime="2024-04-22T13:14:48.676Z" itemprop="datePublished">
                            <a><i class="fa fa-calendar"></i> 2024-04-22</a>
                        </time>
                        
                        
                            <!-- 当前仅支持valine/waline自带的统计功能 -->
                            
                        
                        
                            <!-- 当前仅支持waline自带的统计功能 -->
                            
                        
                    </span>
                    
                    
                        <span class="pull-right">
                            <a class="read-more" href="/2024/04/22/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/GO_lang/go%20%E5%9F%BA%E7%A1%80/" title="留言">留言<i class="fa fa-chevron-circle-right"></i></a>
                        </span>
                    

                </footer>
            
        </article>
    

    
    
        <article class="kratos-hentry kratos-entry-border-new clearfix" itemscope itemtype="https://schema.org/Article">
            <div class="kratos-status">
                
                    <i class="fa fa-refresh"></i>
                
                <div class="kratos-status-inner">
                    <div class="kratos-status-content" itemprop="articleBody">
                        
                            
                        
                    </div>
                </div>
            </div>
            
                <footer class="kratos-post-meta-new">
                    <span class="pull-left">
                        <time datetime="2024-04-22T13:14:48.629Z" itemprop="datePublished">
                            <a><i class="fa fa-calendar"></i> 2024-04-22</a>
                        </time>
                        
                        
                            <!-- 当前仅支持valine/waline自带的统计功能 -->
                            
                        
                        
                            <!-- 当前仅支持waline自带的统计功能 -->
                            
                        
                    </span>
                    
                    
                        <span class="pull-right">
                            <a class="read-more" href="/2024/04/22/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/TEMP/" title="留言">留言<i class="fa fa-chevron-circle-right"></i></a>
                        </span>
                    

                </footer>
            
        </article>
    

    
    
        <article class="kratos-hentry kratos-entry-border-new clearfix" itemscope itemtype="https://schema.org/Article">
            <div class="kratos-status">
                
                    <i class="fa fa-refresh"></i>
                
                <div class="kratos-status-inner">
                    <div class="kratos-status-content" itemprop="articleBody">
                        
                            <p>这是一个测试文件</p>

                        
                    </div>
                </div>
            </div>
            
                <footer class="kratos-post-meta-new">
                    <span class="pull-left">
                        <time datetime="2024-04-22T12:47:56.511Z" itemprop="datePublished">
                            <a><i class="fa fa-calendar"></i> 2024-04-22</a>
                        </time>
                        
                        
                            <!-- 当前仅支持valine/waline自带的统计功能 -->
                            
                        
                        
                            <!-- 当前仅支持waline自带的统计功能 -->
                            
                        
                    </span>
                    
                    
                        <span class="pull-right">
                            <a class="read-more" href="/2024/04/22/test/" title="留言">留言<i class="fa fa-chevron-circle-right"></i></a>
                        </span>
                    

                </footer>
            
        </article>
    

    
    
        <article class="kratos-hentry clearfix" itemscope itemtype="https://schema.org/Article">
            <div class="kratos-entry-border-new clearfix">
                
                <div class="kratos-entry-thumb-new">
                    <a href="/2024/04/22/hello-world/">
                        
                            <img class="kratos-entry-thumb-new-img" alt="">
                        
                    </a>
                </div>
                <div class="kratos-post-inner-new">
                    <header class="kratos-entry-header-new">
                            
                        <h2 class="kratos-entry-title-new"><a href="/2024/04/22/hello-world/" itemprop="mainEntityOfPage"><span itemprop="name headline">Hello Worldaaaaaaa</span></a>
                    </header>
                    <div class="kratos-entry-content-new">
                        <p itemProp="description">
                            
                                Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using ...
                            
                        </p>
                    </div>
                </div>
                <footer class="kratos-post-meta-new">
                    <span class="pull-left">
                        <time datetime="2024-04-22T08:33:35.137Z" itemprop="datePublished">
                            <a><i class="fa fa-calendar"></i> 2024-04-22</a>
                        </time>
                        <a>
                            
                        </a>
                        
                            <!-- 当前仅支持valine/waline自带的统计功能 -->
                            
                        
                        
                            <!-- 当前仅支持waline自带的统计功能 -->
                            
                        
                    </span>
                    <span class="pull-right">
                        <a class="read-more" href="/2024/04/22/hello-world/" title="阅读全文">阅读全文<i class="fa fa-chevron-circle-right"></i></a>
                    </span>
                </footer>
            </div>
        </article>
    



    <div class='text-center pagination'>
    <a class="extend prev" rel="prev" href="/page/9/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span>
    </div>



    <div class="hidden">
        <!-- 加载文章阅读对应的统计功能，评论自带的那种 -->
        
    </div>



        

            </section>

        

                
            

<section id="kratos-widget-area" class="col-md-4 hidden-xs hidden-sm">
    <!-- 文章和页面根据splitter来分割，没有的话就从头开始设置为sticky -->
    
        <div class="sticky-area">
    
    
                <aside id="krw-about" class="widget widget-kratos-about clearfix">
    <div class="photo-background"></div>
    <div class="photo-wrapper clearfix">
        <div class="photo-wrapper-tip text-center">
            <img class="about-photo" src="/images/avatar.webp" loading="lazy" decoding="auto" />
        </div>
    </div>
    <div class="textwidget">
        <p class="text-center"></p>
    </div>
    <div class="site-meta">
        <a class="meta-item" href="/archives/">
            <span class="title">
                文章
            </span>
            <span class="count">
                97
            </span>
        </a>
        <a class="meta-item" href="/categories/">
            <span class="title">
                分类
            </span>
            <span class="count">
                0
            </span>
        </a>
        <a class="meta-item" href="/tags/">
            <span class="title">
                标签
            </span>
            <span class="count">
                0
            </span>
        </a>
    </div>
</aside>
            
                

            
                
            
                
  <aside id="krw-posts" class="widget widget-kratos-posts">
  <h4 class="widget-title"><i class="fa fa-file"></i>最新文章</h4>
  <div class="tab-content">
      <ul class="list-group">
        
        
          
          
        
          
          
        
          
          
        
          
          
            <a class="list-group-item" href="/2024/04/22/TEMP%EF%BC%9A%E4%B8%AD%E9%93%81/"><i class="fa  fa-book"></i> Hello Worldaaaaaaa</a>
            
          
        
          
          
        
          
          
            <a class="list-group-item" href="/2024/04/22/%E8%8B%B1%E8%AF%AD%E5%AD%A6%E4%B9%A0/%E8%8B%B1%E8%AF%AD%E5%8D%95%E8%AF%8D/"><i class="fa  fa-book"></i> Englislearning</a>
            
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
        
          
          
            <a class="list-group-item" href="/2024/04/22/hello-world/"><i class="fa  fa-book"></i> Hello Worldaaaaaaa</a>
            
          
        
      </ul>
  </div>
  </aside>

            
    </div>
</section>
        
        </div>
    </div>
</div>
<footer>
    <div id="footer"  class="ap-lrc"  >
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3 footer-list text-center">
                    <ul class="kratos-social-icons">
                        <!-- Keep for compatibility -->
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <!-- New links -->
                        
                    </ul>
                    <ul class="kratos-copyright">
                        <div>
                            <li>&copy; 2024 Hexo 版权所有.</li>
                            <li>本站已运行<span id="span_dt">Loading...</span></li>
                        </div>
                        <div>
                            <li>Theme <a href="https://github.com/Candinya/Kratos-Rebirth" target="_blank">Kratos:Rebirth</a></li>
                            <li>Site built with&nbsp;<i class="fa fa-heart throb" style="color:#d43f57"></i>&nbsp;by John Doe.</li>
                        </div>
                        <div>
                            <li>Powered by <a href="https://hexo.io" target="_blank" rel="nofollow">Hexo</a></li>
                            <li>Hosted on <a href="https://github.io" target="_blank">Github Pages</a></li>
                        </div>
                        <div>
                            
                            
                        </div>
                    </ul>
                </div>
            </div>
        </div>
        <div class="kr-tool text-center">
            <div class="tool">
                
                    <div class="box search-box">
                        <a href="/search/">
                            <span class="fa fa-search"></span>
                        </a>
                    </div>
                
                
                    <div class="box theme-box" id="darkmode-switch">
                        <span class="fa fa-adjust"></span>
                    </div>
                
                
                
            </div>
            <div class="box gotop-box">
                <span class="fa fa-chevron-up"></span>
            </div>
        </div>
    </div>
</footer>
</div>
</div>

        <script defer src="/vendors/bootstrap@3.3.4/dist/js/bootstrap.min.js"></script>
<script defer src="/vendors/nprogress@0.2.0/nprogress.js"></script>
<script>
    if (!window.kr) {
        window.kr = {};
    }
    window.kr.notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));
    window.kr.siteRoot = "/";
</script>


    <script async src="/js/candy.min.js"></script>



    <script defer src="/vendors/aplayer@1.10.1/dist/APlayer.min.js"></script>
    
    <script defer src="/vendors/meting@2.0.1/dist/Meting.min.js"></script>
    <meting-js
        server="netease"
        type="playlist"
        id="3204190542"
        order="random"
        fixed="true"
    >
    </meting-js>



    <script defer src="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<script defer src="/js/kratosr.min.js"></script>
<script defer src="/js/pjax.min.js"></script>



<!-- Extra support for third-party plguins  -->


    </body>
</html>